"use strict";

var _registry = require("../../registry");

_registry.registry.componentAndEntity({
  typeName: "kubernetesService",
  displayTypeName: "Kubernetes Service Object",
  siPathName: "si-kubernetes",
  serviceName: "kubernetes",
  options: function options(c) {
    c.entity.associations.belongsTo({
      fromFieldPath: ["siProperties", "billingAccountId"],
      typeName: "billingAccount"
    });
    c.entity.integrationServices.push({
      integrationName: "aws",
      integrationServiceName: "eks_kubernetes"
    }); // Constraints
    //
    // TODO(fnicho): this should be a common enum across all AWS/EKS related
    // objects

    c.constraints.addEnum({
      name: "kubernetesVersion",
      label: "Kubernetes Version",
      options: function options(p) {
        p.variants = ["v1.12", "v1.13", "v1.14", "v1.15"];
      }
    }); // Properties

    c.properties.addObject({
      name: "kubernetesObject",
      label: "Kubernetes Object",
      options: function options(p) {
        p.relationships.updates({
          partner: {
            typeName: "kubernetesServiceEntity",
            names: ["properties", "kubernetesObjectYaml"]
          }
        });
        p.relationships.either({
          partner: {
            typeName: "kubernetesServiceEntity",
            names: ["properties", "kubernetesObjectYaml"]
          }
        });
        p.properties.addText({
          name: "apiVersion",
          label: "API Version",
          options: function options(p) {
            p.required = true;
          }
        });
        p.properties.addText({
          name: "kind",
          label: "Kind",
          options: function options(p) {
            p.required = true;
            p.baseDefaultValue = "Service";
          }
        });
        p.properties.addLink({
          name: "metadata",
          label: "Metadat",
          options: function options(p) {
            p.lookup = {
              typeName: "kubernetesMetadata"
            };
          }
        });
        p.properties.addObject({
          name: "spec",
          label: "Service Spec",
          options: function options(p) {
            // TODO(fnichol): The specification records this field in YAML as
            // `clusterIP`
            p.properties.addText({
              name: "clusterIp",
              label: "Host IP"
            }); // TODO(fnichol): The specification records this field in YAML as
            // `externalIPs`

            p.properties.addText({
              name: "externalIps",
              label: "External IPs",
              options: function options(p) {
                p.repeated = true;
              }
            });
            p.properties.addText({
              name: "externalName",
              label: "External Name"
            });
            p.properties.addEnum({
              name: "externalTrafficPolicy",
              label: "External Traffic Policy",
              options: function options(p) {
                p.variants = ["Local", "Cluster"];
              }
            });
            p.properties.addNumber({
              name: "healthCheckNodePort",
              label: "Health Check Node Port",
              options: function options(p) {
                p.numberKind = "uint32";
              }
            });
            p.properties.addEnum({
              name: "ipFamily",
              label: "IP Family",
              options: function options(p) {
                p.variants = ["IPv4", "IPv6"];
              }
            }); // TODO(fnichol); The specification records this field in YAML as
            // `LoadBalancerIP`

            p.properties.addText({
              name: "loadBalancerIp",
              label: "Load Balancer IP"
            });
            p.properties.addText({
              name: "loadBalancerSourceRanges",
              label: "Load Balancer Source Ranges",
              options: function options(p) {
                p.repeated = true;
              }
            });
            p.properties.addLink({
              name: "ports",
              label: "Ports",
              options: function options(p) {
                p.repeated = true;
                p.lookup = {
                  typeName: "kubernetesServicePort"
                };
              }
            });
            p.properties.addBool({
              name: "publishNotReadyAddress",
              label: "Publish Not Ready Address",
              options: function options(p) {
                p.baseDefaultValue = false;
              }
            });
            p.properties.addLink({
              name: "selector",
              label: "Selector",
              options: function options(p) {
                p.lookup = {
                  typeName: "kubernetesSelector"
                };
              }
            });
            p.properties.addEnum({
              name: "sessionAffinity",
              label: "Session Affinity",
              options: function options(p) {
                p.variants = ["ClientIP", "None"];
                p.baseDefaultValue = "None";
              }
            });
            p.properties.addObject({
              name: "sessionAffinityConfig",
              label: "Session Affinity Config",
              options: function options(p) {
                // TODO(fnichol): The specification records this field in YAML
                // as `clientIP`
                p.properties.addObject({
                  name: "clientIp",
                  label: "Client IP Config",
                  options: function options(p) {
                    p.properties.addNumber({
                      name: "timeoutSeconds",
                      label: "Timeout Seconds",
                      options: function options(p) {
                        p.numberKind = "uint32"; // Default is 3 hours

                        p.baseDefaultValue = "10800";
                      }
                    });
                  }
                });
              }
            });
            p.properties.addText({
              name: "topologyKeys",
              label: "Topology Keys",
              options: function options(p) {
                p.repeated = true;
              }
            });
            p.properties.addEnum({
              name: "type",
              label: "Type",
              options: function options(p) {
                p.variants = ["ExternalName", "ClusterIP", "NodePort", "LoadBalancer"];
                p.baseDefaultValue = "ClusterIP";
              }
            });
          }
        });
        p.properties.addObject({
          name: "status",
          label: "Service Status",
          options: function options(p) {
            p.properties.addLink({
              name: "loadBalancer",
              label: "Load Balancer Status",
              options: function options(p) {
                p.lookup = {
                  typeName: "kubernetesLoadBalancerStatus"
                };
              }
            });
          }
        });
      }
    });
    c.properties.addCode({
      name: "kubernetesObjectYaml",
      label: "Kubernetes Object YAML",
      options: function options(p) {
        p.relationships.updates({
          partner: {
            typeName: "kubernetesServiceEntity",
            names: ["properties", "kubernetesObject"]
          }
        });
        p.relationships.either({
          partner: {
            typeName: "kubernetesServiceEntity",
            names: ["properties", "kubernetesObject"]
          }
        });
        p.language = "yaml";
      }
    });
  }
});

_registry.registry.base({
  typeName: "kubernetesServicePort",
  displayTypeName: "Kubernetes Service Port",
  serviceName: "kubernetes",
  options: function options(c) {
    c.fields.addText({
      name: "appProtocol",
      label: "App Protocol"
    });
    c.fields.addText({
      name: "name",
      label: "Name"
    });
    c.fields.addNumber({
      name: "nodePort",
      label: "Node Port",
      options: function options(p) {
        p.numberKind = "uint32";
      }
    });
    c.fields.addNumber({
      name: "port",
      label: "Port",
      options: function options(p) {
        p.numberKind = "uint32";
      }
    });
    c.fields.addEnum({
      name: "protocol",
      label: "Protocol",
      options: function options(p) {
        p.variants = ["TCP", "UDP", "SCTP"];
        p.baseDefaultValue = "TCP";
      }
    }); // NOTE: "Number or name of the port...", implying either an integer or
    // string name. ugh.

    c.fields.addText({
      name: "targetPort",
      label: "Target Port"
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3NpLWt1YmVybmV0ZXMvc2VydmljZS50cyJdLCJuYW1lcyI6WyJyZWdpc3RyeSIsImNvbXBvbmVudEFuZEVudGl0eSIsInR5cGVOYW1lIiwiZGlzcGxheVR5cGVOYW1lIiwic2lQYXRoTmFtZSIsInNlcnZpY2VOYW1lIiwib3B0aW9ucyIsImMiLCJlbnRpdHkiLCJhc3NvY2lhdGlvbnMiLCJiZWxvbmdzVG8iLCJmcm9tRmllbGRQYXRoIiwiaW50ZWdyYXRpb25TZXJ2aWNlcyIsInB1c2giLCJpbnRlZ3JhdGlvbk5hbWUiLCJpbnRlZ3JhdGlvblNlcnZpY2VOYW1lIiwiY29uc3RyYWludHMiLCJhZGRFbnVtIiwibmFtZSIsImxhYmVsIiwicCIsInZhcmlhbnRzIiwicHJvcGVydGllcyIsImFkZE9iamVjdCIsInJlbGF0aW9uc2hpcHMiLCJ1cGRhdGVzIiwicGFydG5lciIsIm5hbWVzIiwiZWl0aGVyIiwiYWRkVGV4dCIsInJlcXVpcmVkIiwiYmFzZURlZmF1bHRWYWx1ZSIsImFkZExpbmsiLCJsb29rdXAiLCJyZXBlYXRlZCIsImFkZE51bWJlciIsIm51bWJlcktpbmQiLCJhZGRCb29sIiwiYWRkQ29kZSIsImxhbmd1YWdlIiwiYmFzZSIsImZpZWxkcyJdLCJtYXBwaW5ncyI6Ijs7QUFTQTs7QUFFQUEsbUJBQVNDLGtCQUFULENBQTRCO0FBQzFCQyxFQUFBQSxRQUFRLEVBQUUsbUJBRGdCO0FBRTFCQyxFQUFBQSxlQUFlLEVBQUUsMkJBRlM7QUFHMUJDLEVBQUFBLFVBQVUsRUFBRSxlQUhjO0FBSTFCQyxFQUFBQSxXQUFXLEVBQUUsWUFKYTtBQUsxQkMsRUFBQUEsT0FMMEIsbUJBS2xCQyxDQUxrQixFQUtmO0FBQ1RBLElBQUFBLENBQUMsQ0FBQ0MsTUFBRixDQUFTQyxZQUFULENBQXNCQyxTQUF0QixDQUFnQztBQUM5QkMsTUFBQUEsYUFBYSxFQUFFLENBQUMsY0FBRCxFQUFpQixrQkFBakIsQ0FEZTtBQUU5QlQs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cnQge1xuICBQcm9wQm9vbCxcbiAgUHJvcENvZGUsXG4gIFByb3BFbnVtLFxuICBQcm9wTGluayxcbiAgUHJvcE51bWJlcixcbiAgUHJvcE9iamVjdCxcbiAgUHJvcFRleHQsXG59IGZyb20gXCIuLi8uLi9jb21wb25lbnRzL3ByZWx1ZGVcIjtcbmltcG9ydCB7IHJlZ2lzdHJ5IH0gZnJvbSBcIi4uLy4uL3JlZ2lzdHJ5XCI7XG5cbnJlZ2lzdHJ5LmNvbXBvbmVudEFuZEVudGl0eSh7XG4gIHR5cGVOYW1lOiBcImt1YmVybmV0ZXNTZXJ2aWNlXCIsXG4gIGRpc3BsYXlUeXBlTmFtZTogXCJLdWJlcm5ldGVzIFNlcnZpY2UgT2JqZWN0XCIsXG4gIHNpUGF0aE5hbWU6IFwic2kta3ViZXJuZXRlc1wiLFxuICBzZXJ2aWNlTmFtZTogXCJrdWJlcm5ldGVzXCIsXG4gIG9wdGlvbnMoYykge1xuICAgIGMuZW50aXR5LmFzc29jaWF0aW9ucy5iZWxvbmdzVG8oe1xuICAgICAgZnJvbUZpZWxkUGF0aDogW1wic2lQcm9wZXJ0aWVzXCIsIFwiYmlsbGluZ0FjY291bnRJZFwiXSxcbiAgICAgIHR5cGVOYW1lOiBcImJpbGxpbmdBY2NvdW50XCIsXG4gICAgfSk7XG4gICAgYy5lbnRpdHkuaW50ZWdyYXRpb25TZXJ2aWNlcy5wdXNoKHtcbiAgICAgIGludGVncmF0aW9uTmFtZTogXCJhd3NcIixcbiAgICAgIGludGVncmF0aW9uU2VydmljZU5hbWU6IFwiZWtzX2t1YmVybmV0ZXNcIixcbiAgICB9KTtcblxuICAgIC8vIENvbnN0cmFpbnRzXG4gICAgLy9cbiAgICAvLyBUT0RPKGZuaWNobyk6IHRoaXMgc2hvdWxkIGJlIGEgY29tbW9uIGVudW0gYWNyb3NzIGFsbCBBV1MvRUtTIHJlbGF0ZWRcbiAgICAvLyBvYmplY3RzXG4gICAgYy5jb25zdHJhaW50cy5hZGRFbnVtKHtcbiAgICAgIG5hbWU6IFwia3ViZXJuZXRlc1ZlcnNpb25cIixcbiAgICAgIGxhYmVsOiBcIkt1YmVybmV0ZXMgVmVyc2lvblwiLFxuICAgICAgb3B0aW9ucyhwOiBQcm9wRW51bSkge1xuICAgICAgICBwLnZhcmlhbnRzID0gW1widjEuMTJcIiwgXCJ2MS4xM1wiLCBcInYxLjE0XCIsIFwidjEuMTVcIl07XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gUHJvcGVydGllc1xuICAgIGMucHJvcGVydGllcy5hZGRPYmplY3Qoe1xuICAgICAgbmFtZTogXCJrdWJlcm5ldGVzT2JqZWN0XCIsXG4gICAgICBsYWJlbDogXCJLdWJlcm5ldGVzIE9iamVjdFwiLFxuICAgICAgb3B0aW9ucyhwOiBQcm9wT2JqZWN0KSB7XG4gICAgICAgIHAucmVsYXRpb25zaGlwcy51cGRhdGVzKHtcbiAgICAgICAgICBwYXJ0bmVyOiB7XG4gICAgICAgICAgICB0eXBlTmFtZTogXCJrdWJlcm5ldGVzU2VydmljZUVudGl0eVwiLFxuICAgICAgICAgICAgbmFtZXM6IFtcInByb3BlcnRpZXNcIiwgXCJrdWJlcm5ldGVzT2JqZWN0WWFtbFwiXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZWxhdGlvbnNoaXBzLmVpdGhlcih7XG4gICAgICAgICAgcGFydG5lcjoge1xuICAgICAgICAgICAgdHlwZU5hbWU6IFwia3ViZXJuZXRlc1NlcnZpY2VFbnRpdHlcIixcbiAgICAgICAgICAgIG5hbWVzOiBbXCJwcm9wZXJ0aWVzXCIsIFwia3ViZXJuZXRlc09iamVjdFlhbWxcIl0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImFwaVZlcnNpb25cIixcbiAgICAgICAgICBsYWJlbDogXCJBUEkgVmVyc2lvblwiLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcFRleHQpIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJraW5kXCIsXG4gICAgICAgICAgbGFiZWw6IFwiS2luZFwiLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcFRleHQpIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgICAgcC5iYXNlRGVmYXVsdFZhbHVlID0gXCJTZXJ2aWNlXCI7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucHJvcGVydGllcy5hZGRMaW5rKHtcbiAgICAgICAgICBuYW1lOiBcIm1ldGFkYXRhXCIsXG4gICAgICAgICAgbGFiZWw6IFwiTWV0YWRhdFwiLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcExpbmspIHtcbiAgICAgICAgICAgIHAubG9va3VwID0ge1xuICAgICAgICAgICAgICB0eXBlTmFtZTogXCJrdWJlcm5ldGVzTWV0YWRhdGFcIixcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucHJvcGVydGllcy5hZGRPYmplY3Qoe1xuICAgICAgICAgIG5hbWU6IFwic3BlY1wiLFxuICAgICAgICAgIGxhYmVsOiBcIlNlcnZpY2UgU3BlY1wiLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcE9iamVjdCkge1xuICAgICAgICAgICAgLy8gVE9ETyhmbmljaG9sKTogVGhlIHNwZWNpZmljYXRpb24gcmVjb3JkcyB0aGlzIGZpZWxkIGluIFlBTUwgYXNcbiAgICAgICAgICAgIC8vIGBjbHVzdGVySVBgXG4gICAgICAgICAgICBwLnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgICAgIG5hbWU6IFwiY2x1c3RlcklwXCIsXG4gICAgICAgICAgICAgIGxhYmVsOiBcIkhvc3QgSVBcIixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gVE9ETyhmbmljaG9sKTogVGhlIHNwZWNpZmljYXRpb24gcmVjb3JkcyB0aGlzIGZpZWxkIGluIFlBTUwgYXNcbiAgICAgICAgICAgIC8vIGBleHRlcm5hbElQc2BcbiAgICAgICAgICAgIHAucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICAgICAgbmFtZTogXCJleHRlcm5hbElwc1wiLFxuICAgICAgICAgICAgICBsYWJlbDogXCJFeHRlcm5hbCBJUHNcIixcbiAgICAgICAgICAgICAgb3B0aW9ucyhwOiBQcm9wVGV4dCkge1xuICAgICAgICAgICAgICAgIHAucmVwZWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwLnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgICAgIG5hbWU6IFwiZXh0ZXJuYWxOYW1lXCIsXG4gICAgICAgICAgICAgIGxhYmVsOiBcIkV4dGVybmFsIE5hbWVcIixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZEVudW0oe1xuICAgICAgICAgICAgICBuYW1lOiBcImV4dGVybmFsVHJhZmZpY1BvbGljeVwiLFxuICAgICAgICAgICAgICBsYWJlbDogXCJFeHRlcm5hbCBUcmFmZmljIFBvbGljeVwiLFxuICAgICAgICAgICAgICBvcHRpb25zKHA6IFByb3BFbnVtKSB7XG4gICAgICAgICAgICAgICAgcC52YXJpYW50cyA9IFtcIkxvY2FsXCIsIFwiQ2x1c3RlclwiXTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZE51bWJlcih7XG4gICAgICAgICAgICAgIG5hbWU6IFwiaGVhbHRoQ2hlY2tOb2RlUG9ydFwiLFxuICAgICAgICAgICAgICBsYWJlbDogXCJIZWFsdGggQ2hlY2sgTm9kZSBQb3J0XCIsXG4gICAgICAgICAgICAgIG9wdGlvbnMocDogUHJvcE51bWJlcikge1xuICAgICAgICAgICAgICAgIHAubnVtYmVyS2luZCA9IFwidWludDMyXCI7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHAucHJvcGVydGllcy5hZGRFbnVtKHtcbiAgICAgICAgICAgICAgbmFtZTogXCJpcEZhbWlseVwiLFxuICAgICAgICAgICAgICBsYWJlbDogXCJJUCBGYW1pbHlcIixcbiAgICAgICAgICAgICAgb3B0aW9ucyhwOiBQcm9wRW51bSkge1xuICAgICAgICAgICAgICAgIHAudmFyaWFudHMgPSBbXCJJUHY0XCIsIFwiSVB2NlwiXTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gVE9ETyhmbmljaG9sKTsgVGhlIHNwZWNpZmljYXRpb24gcmVjb3JkcyB0aGlzIGZpZWxkIGluIFlBTUwgYXNcbiAgICAgICAgICAgIC8vIGBMb2FkQmFsYW5jZXJJUGBcbiAgICAgICAgICAgIHAucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICAgICAgbmFtZTogXCJsb2FkQmFsYW5jZXJJcFwiLFxuICAgICAgICAgICAgICBsYWJlbDogXCJMb2FkIEJhbGFuY2VyIElQXCIsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHAucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICAgICAgbmFtZTogXCJsb2FkQmFsYW5jZXJTb3VyY2VSYW5nZXNcIixcbiAgICAgICAgICAgICAgbGFiZWw6IFwiTG9hZCBCYWxhbmNlciBTb3VyY2UgUmFuZ2VzXCIsXG4gICAgICAgICAgICAgIG9wdGlvbnMocDogUHJvcFRleHQpIHtcbiAgICAgICAgICAgICAgICBwLnJlcGVhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZExpbmsoe1xuICAgICAgICAgICAgICBuYW1lOiBcInBvcnRzXCIsXG4gICAgICAgICAgICAgIGxhYmVsOiBcIlBvcnRzXCIsXG4gICAgICAgICAgICAgIG9wdGlvbnMocDogUHJvcExpbmspIHtcbiAgICAgICAgICAgICAgICBwLnJlcGVhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBwLmxvb2t1cCA9IHtcbiAgICAgICAgICAgICAgICAgIHR5cGVOYW1lOiBcImt1YmVybmV0ZXNTZXJ2aWNlUG9ydFwiLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHAucHJvcGVydGllcy5hZGRCb29sKHtcbiAgICAgICAgICAgICAgbmFtZTogXCJwdWJsaXNoTm90UmVhZHlBZGRyZXNzXCIsXG4gICAgICAgICAgICAgIGxhYmVsOiBcIlB1Ymxpc2ggTm90IFJlYWR5IEFkZHJlc3NcIixcbiAgICAgICAgICAgICAgb3B0aW9ucyhwOiBQcm9wQm9vbCkge1xuICAgICAgICAgICAgICAgIHAuYmFzZURlZmF1bHRWYWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwLnByb3BlcnRpZXMuYWRkTGluayh7XG4gICAgICAgICAgICAgIG5hbWU6IFwic2VsZWN0b3JcIixcbiAgICAgICAgICAgICAgbGFiZWw6IFwiU2VsZWN0b3JcIixcbiAgICAgICAgICAgICAgb3B0aW9ucyhwOiBQcm9wTGluaykge1xuICAgICAgICAgICAgICAgIHAubG9va3VwID0ge1xuICAgICAgICAgICAgICAgICAgdHlwZU5hbWU6IFwia3ViZXJuZXRlc1NlbGVjdG9yXCIsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZEVudW0oe1xuICAgICAgICAgICAgICBuYW1lOiBcInNlc3Npb25BZmZpbml0eVwiLFxuICAgICAgICAgICAgICBsYWJlbDogXCJTZXNzaW9uIEFmZmluaXR5XCIsXG4gICAgICAgICAgICAgIG9wdGlvbnMocDogUHJvcEVudW0pIHtcbiAgICAgICAgICAgICAgICBwLnZhcmlhbnRzID0gW1wiQ2xpZW50SVBcIiwgXCJOb25lXCJdO1xuICAgICAgICAgICAgICAgIHAuYmFzZURlZmF1bHRWYWx1ZSA9IFwiTm9uZVwiO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBwLnByb3BlcnRpZXMuYWRkT2JqZWN0KHtcbiAgICAgICAgICAgICAgbmFtZTogXCJzZXNzaW9uQWZmaW5pdHlDb25maWdcIixcbiAgICAgICAgICAgICAgbGFiZWw6IFwiU2Vzc2lvbiBBZmZpbml0eSBDb25maWdcIixcbiAgICAgICAgICAgICAgb3B0aW9ucyhwOiBQcm9wT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhmbmljaG9sKTogVGhlIHNwZWNpZmljYXRpb24gcmVjb3JkcyB0aGlzIGZpZWxkIGluIFlBTUxcbiAgICAgICAgICAgICAgICAvLyBhcyBgY2xpZW50SVBgXG4gICAgICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZE9iamVjdCh7XG4gICAgICAgICAgICAgICAgICBuYW1lOiBcImNsaWVudElwXCIsXG4gICAgICAgICAgICAgICAgICBsYWJlbDogXCJDbGllbnQgSVAgQ29uZmlnXCIsXG4gICAgICAgICAgICAgICAgICBvcHRpb25zKHA6IFByb3BPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZE51bWJlcih7XG4gICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJ0aW1lb3V0U2Vjb25kc1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIlRpbWVvdXQgU2Vjb25kc1wiLFxuICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMocDogUHJvcE51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcC5udW1iZXJLaW5kID0gXCJ1aW50MzJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlZmF1bHQgaXMgMyBob3Vyc1xuICAgICAgICAgICAgICAgICAgICAgICAgcC5iYXNlRGVmYXVsdFZhbHVlID0gXCIxMDgwMFwiO1xuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgICAgICBuYW1lOiBcInRvcG9sb2d5S2V5c1wiLFxuICAgICAgICAgICAgICBsYWJlbDogXCJUb3BvbG9neSBLZXlzXCIsXG4gICAgICAgICAgICAgIG9wdGlvbnMocDogUHJvcFRleHQpIHtcbiAgICAgICAgICAgICAgICBwLnJlcGVhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZEVudW0oe1xuICAgICAgICAgICAgICBuYW1lOiBcInR5cGVcIixcbiAgICAgICAgICAgICAgbGFiZWw6IFwiVHlwZVwiLFxuICAgICAgICAgICAgICBvcHRpb25zKHA6IFByb3BFbnVtKSB7XG4gICAgICAgICAgICAgICAgcC52YXJpYW50cyA9IFtcbiAgICAgICAgICAgICAgICAgIFwiRXh0ZXJuYWxOYW1lXCIsXG4gICAgICAgICAgICAgICAgICBcIkNsdXN0ZXJJUFwiLFxuICAgICAgICAgICAgICAgICAgXCJOb2RlUG9ydFwiLFxuICAgICAgICAgICAgICAgICAgXCJMb2FkQmFsYW5jZXJcIixcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIHAuYmFzZURlZmF1bHRWYWx1ZSA9IFwiQ2x1c3RlcklQXCI7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZE9iamVjdCh7XG4gICAgICAgICAgbmFtZTogXCJzdGF0dXNcIixcbiAgICAgICAgICBsYWJlbDogXCJTZXJ2aWNlIFN0YXR1c1wiLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcE9iamVjdCkge1xuICAgICAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZExpbmsoe1xuICAgICAgICAgICAgICBuYW1lOiBcImxvYWRCYWxhbmNlclwiLFxuICAgICAgICAgICAgICBsYWJlbDogXCJMb2FkIEJhbGFuY2VyIFN0YXR1c1wiLFxuICAgICAgICAgICAgICBvcHRpb25zKHA6IFByb3BMaW5rKSB7XG4gICAgICAgICAgICAgICAgcC5sb29rdXAgPSB7XG4gICAgICAgICAgICAgICAgICB0eXBlTmFtZTogXCJrdWJlcm5ldGVzTG9hZEJhbGFuY2VyU3RhdHVzXCIsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICBjLnByb3BlcnRpZXMuYWRkQ29kZSh7XG4gICAgICBuYW1lOiBcImt1YmVybmV0ZXNPYmplY3RZYW1sXCIsXG4gICAgICBsYWJlbDogXCJLdWJlcm5ldGVzIE9iamVjdCBZQU1MXCIsXG4gICAgICBvcHRpb25zKHA6IFByb3BDb2RlKSB7XG4gICAgICAgIHAucmVsYXRpb25zaGlwcy51cGRhdGVzKHtcbiAgICAgICAgICBwYXJ0bmVyOiB7XG4gICAgICAgICAgICB0eXBlTmFtZTogXCJrdWJlcm5ldGVzU2VydmljZUVudGl0eVwiLFxuICAgICAgICAgICAgbmFtZXM6IFtcInByb3BlcnRpZXNcIiwgXCJrdWJlcm5ldGVzT2JqZWN0XCJdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlbGF0aW9uc2hpcHMuZWl0aGVyKHtcbiAgICAgICAgICBwYXJ0bmVyOiB7XG4gICAgICAgICAgICB0eXBlTmFtZTogXCJrdWJlcm5ldGVzU2VydmljZUVudGl0eVwiLFxuICAgICAgICAgICAgbmFtZXM6IFtcInByb3BlcnRpZXNcIiwgXCJrdWJlcm5ldGVzT2JqZWN0XCJdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLmxhbmd1YWdlID0gXCJ5YW1sXCI7XG4gICAgICB9LFxuICAgIH0pO1xuICB9LFxufSk7XG5cbnJlZ2lzdHJ5LmJhc2Uoe1xuICB0eXBlTmFtZTogXCJrdWJlcm5ldGVzU2VydmljZVBvcnRcIixcbiAgZGlzcGxheVR5cGVOYW1lOiBcIkt1YmVybmV0ZXMgU2VydmljZSBQb3J0XCIsXG4gIHNlcnZpY2VOYW1lOiBcImt1YmVybmV0ZXNcIixcbiAgb3B0aW9ucyhjKSB7XG4gICAgYy5maWVsZHMuYWRkVGV4dCh7XG4gICAgICBuYW1lOiBcImFwcFByb3RvY29sXCIsXG4gICAgICBsYWJlbDogXCJBcHAgUHJvdG9jb2xcIixcbiAgICB9KTtcbiAgICBjLmZpZWxkcy5hZGRUZXh0KHtcbiAgICAgIG5hbWU6IFwibmFtZVwiLFxuICAgICAgbGFiZWw6IFwiTmFtZVwiLFxuICAgIH0pO1xuICAgIGMuZmllbGRzLmFkZE51bWJlcih7XG4gICAgICBuYW1lOiBcIm5vZGVQb3J0XCIsXG4gICAgICBsYWJlbDogXCJOb2RlIFBvcnRcIixcbiAgICAgIG9wdGlvbnMocDogUHJvcE51bWJlcikge1xuICAgICAgICBwLm51bWJlcktpbmQgPSBcInVpbnQzMlwiO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICBjLmZpZWxkcy5hZGROdW1iZXIoe1xuICAgICAgbmFtZTogXCJwb3J0XCIsXG4gICAgICBsYWJlbDogXCJQb3J0XCIsXG4gICAgICBvcHRpb25zKHA6IFByb3BOdW1iZXIpIHtcbiAgICAgICAgcC5udW1iZXJLaW5kID0gXCJ1aW50MzJcIjtcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgYy5maWVsZHMuYWRkRW51bSh7XG4gICAgICBuYW1lOiBcInByb3RvY29sXCIsXG4gICAgICBsYWJlbDogXCJQcm90b2NvbFwiLFxuICAgICAgb3B0aW9ucyhwOiBQcm9wRW51bSkge1xuICAgICAgICBwLnZhcmlhbnRzID0gW1wiVENQXCIsIFwiVURQXCIsIFwiU0NUUFwiXTtcbiAgICAgICAgcC5iYXNlRGVmYXVsdFZhbHVlID0gXCJUQ1BcIjtcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgLy8gTk9URTogXCJOdW1iZXIgb3IgbmFtZSBvZiB0aGUgcG9ydC4uLlwiLCBpbXBseWluZyBlaXRoZXIgYW4gaW50ZWdlciBvclxuICAgIC8vIHN0cmluZyBuYW1lLiB1Z2guXG4gICAgYy5maWVsZHMuYWRkVGV4dCh7XG4gICAgICBuYW1lOiBcInRhcmdldFBvcnRcIixcbiAgICAgIGxhYmVsOiBcIlRhcmdldCBQb3J0XCIsXG4gICAgfSk7XG4gIH0sXG59KTtcbiJdfQ==