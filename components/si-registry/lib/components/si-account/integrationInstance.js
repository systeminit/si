"use strict";

var _registry = require("../../registry");

_registry.registry.system({
  typeName: "integrationInstance",
  displayTypeName: "An instance of an integration with another system",
  siPathName: "si-account",
  serviceName: "account",
  options: function options(c) {
    c.associations.belongsTo({
      fromFieldPath: ["siProperties", "billingAccountId"],
      typeName: "billingAccount"
    });
    c.associations.belongsTo({
      fromFieldPath: ["siProperties", "integrationId"],
      typeName: "integration"
    });
    c.associations.hasList({
      fromFieldPath: ["siProperties", "enabledWorkspaceIdList"],
      fieldName: "workspaces",
      typeName: "workspace"
    });
    c.associations.hasList({
      fromFieldPath: ["siProperties", "enabledOrganizationIdList"],
      fieldName: "organizations",
      typeName: "organization"
    });
    c.fields.addObject({
      name: "optionValues",
      label: "Options for this Integration",
      options: function options(p) {
        p.repeated = true;
        p.properties.addText({
          name: "name",
          label: "The name for this option",
          options: function options(p) {
            p.required = true;
          }
        });
        p.properties.addText({
          name: "value",
          label: "The value for this option",
          options: function options(p) {
            p.required = true;
          }
        });
        p.properties.addLink({
          name: "optionType",
          label: "The type of option",
          options: function options(p) {
            p.required = true;
            p.lookup = {
              typeName: "integration",
              names: ["options", "optionType"]
            };
          }
        });
      }
    }); /// TODO: COMPLETE THE PATTERN AROUND siProperties and deeper nested objects - need to pass it
    //  or define it from some external source.

    c.fields.addObject({
      name: "siProperties",
      label: "SI Internal Properties",
      options: function options(p) {
        p.required = true;
        p.properties.addText({
          name: "billingAccountId",
          label: "Billing Account ID",
          options: function options(p) {
            p.required = true;
          }
        });
        p.properties.addText({
          name: "integrationId",
          label: "Integration ID",
          options: function options(p) {
            p.required = true;
          }
        });
        p.properties.addText({
          name: "enabledWorkspaceIdList",
          label: "List of workspace id's this integration instance is enabled on",
          options: function options(p) {
            p.repeated = true;
            p.required = true;
          }
        });
        p.properties.addText({
          name: "enabledOrganizationIdList",
          label: "List of organization id's this integration instance is enabled on",
          options: function options(p) {
            p.repeated = true;
            p.required = true;
          }
        });
      }
    });
    c.addListMethod();
    c.addGetMethod();
    c.methods.addMethod({
      name: "create",
      label: "Create an Integration",
      options: function options(p) {
        p.mutation = true;
        p.hidden = true;
        p.isPrivate = true;
        p.request.properties.addText({
          name: "name",
          label: "Integration Name",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "displayName",
          label: "Integration Display Name",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addLink({
          name: "optionValues",
          label: "Options for this Integration Instance",
          options: function options(p) {
            p.required = true;
            p.repeated = true;
            p.lookup = {
              typeName: "integrationInstance",
              names: ["optionValues"]
            };
          }
        });
        p.request.properties.addLink({
          name: "siProperties",
          label: "Si Properties",
          options: function options(p) {
            p.required = true;
            p.lookup = {
              typeName: "integrationInstance",
              names: ["siProperties"]
            };
          }
        });
        p.reply.properties.addLink({
          name: "item",
          label: "".concat(c.displayTypeName, " Item"),
          options: function options(p) {
            p.lookup = {
              typeName: "integrationInstance"
            };
          }
        });
      }
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3NpLWFjY291bnQvaW50ZWdyYXRpb25JbnN0YW5jZS50cyJdLCJuYW1lcyI6WyJyZWdpc3RyeSIsInN5c3RlbSIsInR5cGVOYW1lIiwiZGlzcGxheVR5cGVOYW1lIiwic2lQYXRoTmFtZSIsInNlcnZpY2VOYW1lIiwib3B0aW9ucyIsImMiLCJhc3NvY2lhdGlvbnMiLCJiZWxvbmdzVG8iLCJmcm9tRmllbGRQYXRoIiwiaGFzTGlzdCIsImZpZWxkTmFtZSIsImZpZWxkcyIsImFkZE9iamVjdCIsIm5hbWUiLCJsYWJlbCIsInAiLCJyZXBlYXRlZCIsInByb3BlcnRpZXMiLCJhZGRUZXh0IiwicmVxdWlyZWQiLCJhZGRMaW5rIiwibG9va3VwIiwibmFtZXMiLCJhZGRMaXN0TWV0aG9kIiwiYWRkR2V0TWV0aG9kIiwibWV0aG9kcyIsImFkZE1ldGhvZCIsIm11dGF0aW9uIiwiaGlkZGVuIiwiaXNQcml2YXRlIiwicmVxdWVzdCIsInJlcGx5Il0sIm1hcHBpbmdzIjoiOztBQU9BOztBQUdBQSxtQkFBU0MsTUFBVCxDQUFnQjtBQUNkQyxFQUFBQSxRQUFRLEVBQUUscUJBREk7QUFFZEMsRUFBQUEsZUFBZSxFQUFFLG1EQUZIO0FBR2RDLEVBQUFBLFVBQVUsRUFBRSxZQUhFO0FBSWRDLEVBQUFBLFdBQVcsRUFBRSxTQUpDO0FBS2RDLEVBQUFBLE9BTGMsbUJBS05DLENBTE0sRUFLVztBQUN2QkEsSUFBQUEsQ0FBQyxDQUFDQyxZQUFGLENBQWVDLFNBQWYsQ0FBeUI7QUFDdkJDLE1BQUFBLGFBQWEsRUFBRSxDQUFDLGNBQUQsRUFBaUIsa0JBQWpCLENBRFE7QUFFdkJSLE1BQUFBLFFBQVEsRUFBRTtBQUZhLEtBQXpCO0FBSUFLLElBQUFBLENBQUMsQ0FBQ0MsWUFBRixDQUFlQyxTQUFmLENBQXlCO0FBQ3ZCQyxNQUFBQSxhQUFhLEVBQUUsQ0FBQyxjQUFELEVBQWlCLGVBQWpCLENBRFE7QUFFdkJSLE1BQUFBLFFBQVEsRUFB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QUYsR0FBVztBQUNUckIsY0FBQUEsUUFBUSxFQUFFLHFCQUREO0FBRVRzQixjQUFBQSxLQUFLLEVBQUUsQ0FBQyxjQUFEO0FBRkUsYUFBWDtBQUlEO0FBVDBCLFNBQTdCO0FBWUFQLFFBQUFBLENBQUMsQ0FBQ2dCLEtBQUYsQ0FBUWQsVUFBUixDQUFtQkcsT0FBbkIsQ0FBMkI7QUFDekJQLFVBQUFBLElBQUksRUFBRSxNQURtQjtBQUV6QkMsVUFBQUEsS0FBSyxZQUFLVCxDQUFDLENBQUNKLGVBQVAsVUFGb0I7QUFHekJHLFVBQUFBLE9BSHlCLG1CQUdqQlcsQ0FIaUIsRUFHSjtBQUNuQkEsWUFBQUEsQ0FBQyxDQUFDTSxNQUFGLEdBQVc7QUFDVHJCLGNBQUFBLFFBQVEsRUFBRTtBQURELGFBQVg7QUFHRDtBQVB3QixTQUEzQjtBQVNEO0FBdERpQixLQUFwQjtBQXdERDtBQTdKYSxDQUFoQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIFByb3BPYmplY3QsXG4gIFByb3BNZXRob2QsXG4gIFByb3BMaW5rLFxuICBQcm9wVGV4dCxcbiAgUHJvcE51bWJlcixcbn0gZnJvbSBcIi4uLy4uL2NvbXBvbmVudHMvcHJlbHVkZVwiO1xuaW1wb3J0IHsgcmVnaXN0cnkgfSBmcm9tIFwiLi4vLi4vcmVnaXN0cnlcIjtcbmltcG9ydCB7IFN5c3RlbU9iamVjdCB9IGZyb20gXCIuLi8uLi9zeXN0ZW1Db21wb25lbnRcIjtcblxucmVnaXN0cnkuc3lzdGVtKHtcbiAgdHlwZU5hbWU6IFwiaW50ZWdyYXRpb25JbnN0YW5jZVwiLFxuICBkaXNwbGF5VHlwZU5hbWU6IFwiQW4gaW5zdGFuY2Ugb2YgYW4gaW50ZWdyYXRpb24gd2l0aCBhbm90aGVyIHN5c3RlbVwiLFxuICBzaVBhdGhOYW1lOiBcInNpLWFjY291bnRcIixcbiAgc2VydmljZU5hbWU6IFwiYWNjb3VudFwiLFxuICBvcHRpb25zKGM6IFN5c3RlbU9iamVjdCkge1xuICAgIGMuYXNzb2NpYXRpb25zLmJlbG9uZ3NUbyh7XG4gICAgICBmcm9tRmllbGRQYXRoOiBbXCJzaVByb3BlcnRpZXNcIiwgXCJiaWxsaW5nQWNjb3VudElkXCJdLFxuICAgICAgdHlwZU5hbWU6IFwiYmlsbGluZ0FjY291bnRcIixcbiAgICB9KTtcbiAgICBjLmFzc29jaWF0aW9ucy5iZWxvbmdzVG8oe1xuICAgICAgZnJvbUZpZWxkUGF0aDogW1wic2lQcm9wZXJ0aWVzXCIsIFwiaW50ZWdyYXRpb25JZFwiXSxcbiAgICAgIHR5cGVOYW1lOiBcImludGVncmF0aW9uXCIsXG4gICAgfSk7XG4gICAgYy5hc3NvY2lhdGlvbnMuaGFzTGlzdCh7XG4gICAgICBmcm9tRmllbGRQYXRoOiBbXCJzaVByb3BlcnRpZXNcIiwgXCJlbmFibGVkV29ya3NwYWNlSWRMaXN0XCJdLFxuICAgICAgZmllbGROYW1lOiBcIndvcmtzcGFjZXNcIixcbiAgICAgIHR5cGVOYW1lOiBcIndvcmtzcGFjZVwiLFxuICAgIH0pO1xuICAgIGMuYXNzb2NpYXRpb25zLmhhc0xpc3Qoe1xuICAgICAgZnJvbUZpZWxkUGF0aDogW1wic2lQcm9wZXJ0aWVzXCIsIFwiZW5hYmxlZE9yZ2FuaXphdGlvbklkTGlzdFwiXSxcbiAgICAgIGZpZWxkTmFtZTogXCJvcmdhbml6YXRpb25zXCIsXG4gICAgICB0eXBlTmFtZTogXCJvcmdhbml6YXRpb25cIixcbiAgICB9KTtcblxuICAgIGMuZmllbGRzLmFkZE9iamVjdCh7XG4gICAgICBuYW1lOiBcIm9wdGlvblZhbHVlc1wiLFxuICAgICAgbGFiZWw6IFwiT3B0aW9ucyBmb3IgdGhpcyBJbnRlZ3JhdGlvblwiLFxuICAgICAgb3B0aW9ucyhwOiBQcm9wT2JqZWN0KSB7XG4gICAgICAgIHAucmVwZWF0ZWQgPSB0cnVlO1xuICAgICAgICBwLnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJuYW1lXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVGhlIG5hbWUgZm9yIHRoaXMgb3B0aW9uXCIsXG4gICAgICAgICAgb3B0aW9ucyhwOiBQcm9wVGV4dCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcInZhbHVlXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVGhlIHZhbHVlIGZvciB0aGlzIG9wdGlvblwiLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcFRleHQpIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnByb3BlcnRpZXMuYWRkTGluayh7XG4gICAgICAgICAgbmFtZTogXCJvcHRpb25UeXBlXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVGhlIHR5cGUgb2Ygb3B0aW9uXCIsXG4gICAgICAgICAgb3B0aW9ucyhwOiBQcm9wTGluaykge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgICBwLmxvb2t1cCA9IHtcbiAgICAgICAgICAgICAgdHlwZU5hbWU6IFwiaW50ZWdyYXRpb25cIixcbiAgICAgICAgICAgICAgbmFtZXM6IFtcIm9wdGlvbnNcIiwgXCJvcHRpb25UeXBlXCJdLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgLy8vIFRPRE86IENPTVBMRVRFIFRIRSBQQVRURVJOIEFST1VORCBzaVByb3BlcnRpZXMgYW5kIGRlZXBlciBuZXN0ZWQgb2JqZWN0cyAtIG5lZWQgdG8gcGFzcyBpdFxuICAgIC8vICBvciBkZWZpbmUgaXQgZnJvbSBzb21lIGV4dGVybmFsIHNvdXJjZS5cbiAgICBjLmZpZWxkcy5hZGRPYmplY3Qoe1xuICAgICAgbmFtZTogXCJzaVByb3BlcnRpZXNcIixcbiAgICAgIGxhYmVsOiBcIlNJIEludGVybmFsIFByb3BlcnRpZXNcIixcbiAgICAgIG9wdGlvbnMocDogUHJvcE9iamVjdCkge1xuICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiYmlsbGluZ0FjY291bnRJZFwiLFxuICAgICAgICAgIGxhYmVsOiBcIkJpbGxpbmcgQWNjb3VudCBJRFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImludGVncmF0aW9uSWRcIixcbiAgICAgICAgICBsYWJlbDogXCJJbnRlZ3JhdGlvbiBJRFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImVuYWJsZWRXb3Jrc3BhY2VJZExpc3RcIixcbiAgICAgICAgICBsYWJlbDpcbiAgICAgICAgICAgIFwiTGlzdCBvZiB3b3Jrc3BhY2UgaWQncyB0aGlzIGludGVncmF0aW9uIGluc3RhbmNlIGlzIGVuYWJsZWQgb25cIixcbiAgICAgICAgICBvcHRpb25zKHA6IFByb3BUZXh0KSB7XG4gICAgICAgICAgICBwLnJlcGVhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJlbmFibGVkT3JnYW5pemF0aW9uSWRMaXN0XCIsXG4gICAgICAgICAgbGFiZWw6XG4gICAgICAgICAgICBcIkxpc3Qgb2Ygb3JnYW5pemF0aW9uIGlkJ3MgdGhpcyBpbnRlZ3JhdGlvbiBpbnN0YW5jZSBpcyBlbmFibGVkIG9uXCIsXG4gICAgICAgICAgb3B0aW9ucyhwOiBQcm9wVGV4dCkge1xuICAgICAgICAgICAgcC5yZXBlYXRlZCA9IHRydWU7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjLmFkZExpc3RNZXRob2QoKTtcbiAgICBjLmFkZEdldE1ldGhvZCgpO1xuICAgIGMubWV0aG9kcy5hZGRNZXRob2Qoe1xuICAgICAgbmFtZTogXCJjcmVhdGVcIixcbiAgICAgIGxhYmVsOiBcIkNyZWF0ZSBhbiBJbnRlZ3JhdGlvblwiLFxuICAgICAgb3B0aW9ucyhwOiBQcm9wTWV0aG9kKSB7XG4gICAgICAgIHAubXV0YXRpb24gPSB0cnVlO1xuICAgICAgICBwLmhpZGRlbiA9IHRydWU7XG4gICAgICAgIHAuaXNQcml2YXRlID0gdHJ1ZTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJuYW1lXCIsXG4gICAgICAgICAgbGFiZWw6IFwiSW50ZWdyYXRpb24gTmFtZVwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiZGlzcGxheU5hbWVcIixcbiAgICAgICAgICBsYWJlbDogXCJJbnRlZ3JhdGlvbiBEaXNwbGF5IE5hbWVcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRMaW5rKHtcbiAgICAgICAgICBuYW1lOiBcIm9wdGlvblZhbHVlc1wiLFxuICAgICAgICAgIGxhYmVsOiBcIk9wdGlvbnMgZm9yIHRoaXMgSW50ZWdyYXRpb24gSW5zdGFuY2VcIixcbiAgICAgICAgICBvcHRpb25zKHA6IFByb3BMaW5rKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHAucmVwZWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgcC5sb29rdXAgPSB7XG4gICAgICAgICAgICAgIHR5cGVOYW1lOiBcImludGVncmF0aW9uSW5zdGFuY2VcIixcbiAgICAgICAgICAgICAgbmFtZXM6IFtcIm9wdGlvblZhbHVlc1wiXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZExpbmsoe1xuICAgICAgICAgIG5hbWU6IFwic2lQcm9wZXJ0aWVzXCIsXG4gICAgICAgICAgbGFiZWw6IFwiU2kgUHJvcGVydGllc1wiLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcExpbmspIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgICAgcC5sb29rdXAgPSB7XG4gICAgICAgICAgICAgIHR5cGVOYW1lOiBcImludGVncmF0aW9uSW5zdGFuY2VcIixcbiAgICAgICAgICAgICAgbmFtZXM6IFtcInNpUHJvcGVydGllc1wiXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcC5yZXBseS5wcm9wZXJ0aWVzLmFkZExpbmsoe1xuICAgICAgICAgIG5hbWU6IFwiaXRlbVwiLFxuICAgICAgICAgIGxhYmVsOiBgJHtjLmRpc3BsYXlUeXBlTmFtZX0gSXRlbWAsXG4gICAgICAgICAgb3B0aW9ucyhwOiBQcm9wTGluaykge1xuICAgICAgICAgICAgcC5sb29rdXAgPSB7XG4gICAgICAgICAgICAgIHR5cGVOYW1lOiBcImludGVncmF0aW9uSW5zdGFuY2VcIixcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0pO1xuICB9LFxufSk7XG4iXX0=