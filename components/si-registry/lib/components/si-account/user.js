"use strict";

var _registry = require("../../registry");

_registry.registry.system({
  typeName: "user",
  displayTypeName: "A System Initiative User",
  siPathName: "si-account",
  serviceName: "account",
  options: function options(c) {
    c.naturalKey = "email";
    c.associations.belongsTo({
      fromFieldPath: ["siProperties", "billingAccountId"],
      typeName: "billingAccount"
    });
    c.fields.addText({
      name: "email",
      label: "A valid email address",
      options: function options(p) {
        p.universal = true;
        p.required = true;
      }
    });
    c.fields.addPassword({
      name: "password",
      label: "The users password hash",
      options: function options(p) {
        p.universal = true;
        p.required = true;
        p.hidden = true;
        p.skip = true;
      }
    });
    c.fields.addObject({
      name: "siProperties",
      label: "SI Internal Properties",
      options: function options(p) {
        p.required = true;
        p.properties.addText({
          name: "billingAccountId",
          label: "Billing Account ID",
          options: function options(p) {
            p.required = true;
          }
        });
      }
    });
    c.fields.addLink({
      name: "capabilities",
      label: "Authorized capabilities for this user",
      options: function options(p) {
        p.hidden = true;
        p.lookup = {
          typeName: "capability"
        };
      }
    });
    c.addListMethod();
    c.addGetMethod();
    c.methods.addMethod({
      name: "loginInternal",
      label: "Login",
      options: function options(p) {
        p.isPrivate = true;
        p.skipAuth = true;
        p.request.properties.addText({
          name: "email",
          label: "Email",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addPassword({
          name: "password",
          label: "Password",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "billingAccountName",
          label: "Billing Account",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addBool({
          name: "authenticated",
          label: "Authenticated",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addText({
          name: "userId",
          label: "User Id",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addText({
          name: "billingAccountId",
          label: "Billing Account Id",
          options: function options(p) {
            p.required = true;
          }
        });
      }
    });
    c.methods.addMethod({
      name: "create",
      label: "Create a User",
      options: function options(p) {
        p.mutation = true;
        p.request.properties.addText({
          name: "name",
          label: "User Name",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "displayName",
          label: "User Display Name",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "email",
          label: "Users email address",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addPassword({
          name: "password",
          label: "Users password",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addLink({
          name: "siProperties",
          label: "The SI Properties for this User",
          options: function options(p) {
            p.required = true;
            p.lookup = {
              typeName: "user",
              names: ["siProperties"]
            };
          }
        });
        p.reply.properties.addLink({
          name: "item",
          label: "".concat(c.displayTypeName, " Item"),
          options: function options(p) {
            p.lookup = {
              typeName: "user"
            };
          }
        });
      }
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3NpLWFjY291bnQvdXNlci50cyJdLCJuYW1lcyI6WyJyZWdpc3RyeSIsInN5c3RlbSIsInR5cGVOYW1lIiwiZGlzcGxheVR5cGVOYW1lIiwic2lQYXRoTmFtZSIsInNlcnZpY2VOYW1lIiwib3B0aW9ucyIsImMiLCJuYXR1cmFsS2V5IiwiYXNzb2NpYXRpb25zIiwiYmVsb25nc1RvIiwiZnJvbUZpZWxkUGF0aCIsImZpZWxkcyIsImFkZFRleHQiLCJuYW1lIiwibGFiZWwiLCJwIiwidW5pdmVyc2FsIiwicmVxdWlyZWQiLCJhZGRQYXNzd29yZCIsImhpZGRlbiIsInNraXAiLCJhZGRPYmplY3QiLCJwcm9wZXJ0aWVzIiwiYWRkTGluayIsImxvb2t1cCIsImFkZExpc3RNZXRob2QiLCJhZGRHZXRNZXRob2QiLCJtZXRob2RzIiwiYWRkTWV0aG9kIiwiaXNQcml2YXRlIiwic2tpcEF1dGgiLCJyZXF1ZXN0IiwicmVwbHkiLCJhZGRCb29sIiwibXV0YXRpb24iLCJuYW1lcyJdLCJtYXBwaW5ncyI6Ijs7QUFDQTs7QUFHQUEsbUJBQVNDLE1BQVQsQ0FBZ0I7QUFDZEMsRUFBQUEsUUFBUSxFQUFFLE1BREk7QUFFZEMsRUFBQUEsZUFBZSxFQUFFLDBCQUZIO0FBR2RDLEVBQUFBLFVBQVUsRUFBRSxZQUhFO0FBSWRDLEVBQUFBLFdBQVcsRUFBRSxTQUpDO0FBS2RDLEVBQUFBLE9BTGMsbUJBS05DLENBTE0sRUFLVztBQUN2QkEsSUFBQUEsQ0FBQyxDQUFDQyxVQUFGLEdBQWUsT0FBZjtBQUVBRCxJQUFBQSxDQUFDLENBQUNFLFlBQUYsQ0FBZUMsU0FBZixDQUF5QjtBQUN2QkMsTUFBQUEsYUFBYSxFQUFFLENBQUMsY0FBRCxFQUFpQixrQkFBakIsQ0FEUTtBQUV2QlQsTUFBQUEsUUFBUSxFQUFFO0FBRmEsS0FBekI7QUFLQUssSUFBQUEsQ0FBQyxDQUFDSyxNQUFGLENBQVNDLE9BQVQsQ0FBaUI7QUFDZkMsTUFBQUEsSUFB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QUUsZ0JBRndCO0FBRy9CVCxVQUFBQSxPQUgrQixtQkFHdkJVLENBSHVCLEVBR3BCO0FBQ1RBLFlBQUFBLENBQUMsQ0FBQ0UsUUFBRixHQUFhLElBQWI7QUFDRDtBQUw4QixTQUFqQztBQU9BRixRQUFBQSxDQUFDLENBQUNnQixPQUFGLENBQVVULFVBQVYsQ0FBcUJDLE9BQXJCLENBQTZCO0FBQzNCVixVQUFBQSxJQUFJLEVBQUUsY0FEcUI7QUFFM0JDLFVBQUFBLEtBQUssRUFBRSxpQ0FGb0I7QUFHM0JULFVBQUFBLE9BSDJCLG1CQUduQlUsQ0FIbUIsRUFHTjtBQUNuQkEsWUFBQUEsQ0FBQyxDQUFDRSxRQUFGLEdBQWEsSUFBYjtBQUNBRixZQUFBQSxDQUFDLENBQUNTLE1BQUYsR0FBVztBQUNUdkIsY0FBQUEsUUFBUSxFQUFFLE1BREQ7QUFFVGtDLGNBQUFBLEtBQUssRUFBRSxDQUFDLGNBQUQ7QUFGRSxhQUFYO0FBSUQ7QUFUMEIsU0FBN0I7QUFXQXBCLFFBQUFBLENBQUMsQ0FBQ2lCLEtBQUYsQ0FBUVYsVUFBUixDQUFtQkMsT0FBbkIsQ0FBMkI7QUFDekJWLFVBQUFBLElBQUksRUFBRSxNQURtQjtBQUV6QkMsVUFBQUEsS0FBSyxZQUFLUixDQUFDLENBQUNKLGVBQVAsVUFGb0I7QUFHekJHLFVBQUFBLE9BSHlCLG1CQUdqQlUsQ0FIaUIsRUFHSjtBQUNuQkEsWUFBQUEsQ0FBQyxDQUFDUyxNQUFGLEdBQVc7QUFDVHZCLGNBQUFBLFFBQVEsRUFBRTtBQURELGFBQVg7QUFHRDtBQVB3QixTQUEzQjtBQVNEO0FBckRpQixLQUFwQjtBQXVERDtBQXJLYSxDQUFoQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByb3BPYmplY3QsIFByb3BNZXRob2QsIFByb3BMaW5rIH0gZnJvbSBcIi4uLy4uL2NvbXBvbmVudHMvcHJlbHVkZVwiO1xuaW1wb3J0IHsgcmVnaXN0cnkgfSBmcm9tIFwiLi4vLi4vcmVnaXN0cnlcIjtcbmltcG9ydCB7IFN5c3RlbU9iamVjdCB9IGZyb20gXCIuLi8uLi9zeXN0ZW1Db21wb25lbnRcIjtcblxucmVnaXN0cnkuc3lzdGVtKHtcbiAgdHlwZU5hbWU6IFwidXNlclwiLFxuICBkaXNwbGF5VHlwZU5hbWU6IFwiQSBTeXN0ZW0gSW5pdGlhdGl2ZSBVc2VyXCIsXG4gIHNpUGF0aE5hbWU6IFwic2ktYWNjb3VudFwiLFxuICBzZXJ2aWNlTmFtZTogXCJhY2NvdW50XCIsXG4gIG9wdGlvbnMoYzogU3lzdGVtT2JqZWN0KSB7XG4gICAgYy5uYXR1cmFsS2V5ID0gXCJlbWFpbFwiO1xuXG4gICAgYy5hc3NvY2lhdGlvbnMuYmVsb25nc1RvKHtcbiAgICAgIGZyb21GaWVsZFBhdGg6IFtcInNpUHJvcGVydGllc1wiLCBcImJpbGxpbmdBY2NvdW50SWRcIl0sXG4gICAgICB0eXBlTmFtZTogXCJiaWxsaW5nQWNjb3VudFwiLFxuICAgIH0pO1xuXG4gICAgYy5maWVsZHMuYWRkVGV4dCh7XG4gICAgICBuYW1lOiBcImVtYWlsXCIsXG4gICAgICBsYWJlbDogXCJBIHZhbGlkIGVtYWlsIGFkZHJlc3NcIixcbiAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICBwLnVuaXZlcnNhbCA9IHRydWU7XG4gICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICBjLmZpZWxkcy5hZGRQYXNzd29yZCh7XG4gICAgICBuYW1lOiBcInBhc3N3b3JkXCIsXG4gICAgICBsYWJlbDogXCJUaGUgdXNlcnMgcGFzc3dvcmQgaGFzaFwiLFxuICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgIHAudW5pdmVyc2FsID0gdHJ1ZTtcbiAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgIHAuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgcC5za2lwID0gdHJ1ZTtcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgYy5maWVsZHMuYWRkT2JqZWN0KHtcbiAgICAgIG5hbWU6IFwic2lQcm9wZXJ0aWVzXCIsXG4gICAgICBsYWJlbDogXCJTSSBJbnRlcm5hbCBQcm9wZXJ0aWVzXCIsXG4gICAgICBvcHRpb25zKHA6IFByb3BPYmplY3QpIHtcbiAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgIHAucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImJpbGxpbmdBY2NvdW50SWRcIixcbiAgICAgICAgICBsYWJlbDogXCJCaWxsaW5nIEFjY291bnQgSURcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICBjLmZpZWxkcy5hZGRMaW5rKHtcbiAgICAgIG5hbWU6IFwiY2FwYWJpbGl0aWVzXCIsXG4gICAgICBsYWJlbDogXCJBdXRob3JpemVkIGNhcGFiaWxpdGllcyBmb3IgdGhpcyB1c2VyXCIsXG4gICAgICBvcHRpb25zKHA6IFByb3BMaW5rKSB7XG4gICAgICAgIHAuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgcC5sb29rdXAgPSB7XG4gICAgICAgICAgdHlwZU5hbWU6IFwiY2FwYWJpbGl0eVwiLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGMuYWRkTGlzdE1ldGhvZCgpO1xuICAgIGMuYWRkR2V0TWV0aG9kKCk7XG5cbiAgICBjLm1ldGhvZHMuYWRkTWV0aG9kKHtcbiAgICAgIG5hbWU6IFwibG9naW5JbnRlcm5hbFwiLFxuICAgICAgbGFiZWw6IFwiTG9naW5cIixcbiAgICAgIG9wdGlvbnMocDogUHJvcE1ldGhvZCkge1xuICAgICAgICBwLmlzUHJpdmF0ZSA9IHRydWU7XG4gICAgICAgIHAuc2tpcEF1dGggPSB0cnVlO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImVtYWlsXCIsXG4gICAgICAgICAgbGFiZWw6IFwiRW1haWxcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRQYXNzd29yZCh7XG4gICAgICAgICAgbmFtZTogXCJwYXNzd29yZFwiLFxuICAgICAgICAgIGxhYmVsOiBcIlBhc3N3b3JkXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJiaWxsaW5nQWNjb3VudE5hbWVcIixcbiAgICAgICAgICBsYWJlbDogXCJCaWxsaW5nIEFjY291bnRcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcGx5LnByb3BlcnRpZXMuYWRkQm9vbCh7XG4gICAgICAgICAgbmFtZTogXCJhdXRoZW50aWNhdGVkXCIsXG4gICAgICAgICAgbGFiZWw6IFwiQXV0aGVudGljYXRlZFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVwbHkucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcInVzZXJJZFwiLFxuICAgICAgICAgIGxhYmVsOiBcIlVzZXIgSWRcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcGx5LnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJiaWxsaW5nQWNjb3VudElkXCIsXG4gICAgICAgICAgbGFiZWw6IFwiQmlsbGluZyBBY2NvdW50IElkXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjLm1ldGhvZHMuYWRkTWV0aG9kKHtcbiAgICAgIG5hbWU6IFwiY3JlYXRlXCIsXG4gICAgICBsYWJlbDogXCJDcmVhdGUgYSBVc2VyXCIsXG4gICAgICBvcHRpb25zKHA6IFByb3BNZXRob2QpIHtcbiAgICAgICAgcC5tdXRhdGlvbiA9IHRydWU7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwibmFtZVwiLFxuICAgICAgICAgIGxhYmVsOiBcIlVzZXIgTmFtZVwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiZGlzcGxheU5hbWVcIixcbiAgICAgICAgICBsYWJlbDogXCJVc2VyIERpc3BsYXkgTmFtZVwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiZW1haWxcIixcbiAgICAgICAgICBsYWJlbDogXCJVc2VycyBlbWFpbCBhZGRyZXNzXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkUGFzc3dvcmQoe1xuICAgICAgICAgIG5hbWU6IFwicGFzc3dvcmRcIixcbiAgICAgICAgICBsYWJlbDogXCJVc2VycyBwYXNzd29yZFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZExpbmsoe1xuICAgICAgICAgIG5hbWU6IFwic2lQcm9wZXJ0aWVzXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVGhlIFNJIFByb3BlcnRpZXMgZm9yIHRoaXMgVXNlclwiLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcExpbmspIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgICAgcC5sb29rdXAgPSB7XG4gICAgICAgICAgICAgIHR5cGVOYW1lOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgbmFtZXM6IFtcInNpUHJvcGVydGllc1wiXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVwbHkucHJvcGVydGllcy5hZGRMaW5rKHtcbiAgICAgICAgICBuYW1lOiBcIml0ZW1cIixcbiAgICAgICAgICBsYWJlbDogYCR7Yy5kaXNwbGF5VHlwZU5hbWV9IEl0ZW1gLFxuICAgICAgICAgIG9wdGlvbnMocDogUHJvcExpbmspIHtcbiAgICAgICAgICAgIHAubG9va3VwID0ge1xuICAgICAgICAgICAgICB0eXBlTmFtZTogXCJ1c2VyXCIsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfSxcbn0pO1xuIl19