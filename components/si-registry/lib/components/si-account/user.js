"use strict";

var _registry = require("../../registry");

_registry.registry.system({
  typeName: "user",
  displayTypeName: "A System Initiative User",
  siPathName: "si-account",
  serviceName: "account",
  options: function options(c) {
    c.naturalKey = "email";
    c.associations.belongsTo({
      fromFieldPath: ["siProperties", "billingAccountId"],
      typeName: "billingAccount"
    });
    c.fields.addText({
      name: "email",
      label: "A valid email address",
      options: function options(p) {
        p.universal = true;
        p.required = true;
      }
    });
    c.fields.addPassword({
      name: "password",
      label: "The users password hash",
      options: function options(p) {
        p.universal = true;
        p.required = true;
        p.hidden = true;
        p.skip = true;
      }
    });
    c.fields.addObject({
      name: "siProperties",
      label: "SI Internal Properties",
      options: function options(p) {
        p.required = true;
        p.properties.addText({
          name: "billingAccountId",
          label: "Billing Account ID",
          options: function options(p) {
            p.required = true;
          }
        });
      }
    });
    c.fields.addLink({
      name: "capabilities",
      label: "Authorized capabilities for this user",
      options: function options(p) {
        p.hidden = true;
        p.lookup = {
          typeName: "capability"
        };
      }
    });
    c.addListMethod();
    c.addGetMethod();
    c.methods.addMethod({
      name: "loginInternal",
      label: "Login",
      options: function options(p) {
        p.isPrivate = true;
        p.skipAuth = true;
        p.request.properties.addText({
          name: "email",
          label: "Email",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addPassword({
          name: "password",
          label: "Password",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "billingAccountName",
          label: "Billing Account",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addBool({
          name: "authenticated",
          label: "Authenticated",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addText({
          name: "userId",
          label: "User Id",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addText({
          name: "billingAccountId",
          label: "Billing Account Id",
          options: function options(p) {
            p.required = true;
          }
        });
      }
    });
    c.methods.addMethod({
      name: "create",
      label: "Create a User",
      options: function options(p) {
        p.mutation = true;
        p.request.properties.addText({
          name: "name",
          label: "User Name",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "displayName",
          label: "User Display Name",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "email",
          label: "Users email address",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addPassword({
          name: "password",
          label: "Users password",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addLink({
          name: "siProperties",
          label: "The SI Properties for this User",
          options: function options(p) {
            p.required = true;
            p.lookup = {
              typeName: "user",
              names: ["siProperties"]
            };
          }
        });
        p.reply.properties.addLink({
          name: "item",
          label: "".concat(c.displayTypeName, " Item"),
          options: function options(p) {
            p.lookup = {
              typeName: "user"
            };
          }
        });
      }
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3NpLWFjY291bnQvdXNlci50cyJdLCJuYW1lcyI6WyJyZWdpc3RyeSIsInN5c3RlbSIsInR5cGVOYW1lIiwiZGlzcGxheVR5cGVOYW1lIiwic2lQYXRoTmFtZSIsInNlcnZpY2VOYW1lIiwib3B0aW9ucyIsImMiLCJuYXR1cmFsS2V5IiwiYXNzb2NpYXRpb25zIiwiYmVsb25nc1RvIiwiZnJvbUZpZWxkUGF0aCIsImZpZWxkcyIsImFkZFRleHQiLCJuYW1lIiwibGFiZWwiLCJwIiwidW5pdmVyc2FsIiwicmVxdWlyZWQiLCJhZGRQYXNzd29yZCIsImhpZGRlbiIsInNraXAiLCJhZGRPYmplY3QiLCJwcm9wZXJ0aWVzIiwiYWRkTGluayIsImxvb2t1cCIsImFkZExpc3RNZXRob2QiLCJhZGRHZXRNZXRob2QiLCJtZXRob2RzIiwiYWRkTWV0aG9kIiwiaXNQcml2YXRlIiwic2tpcEF1dGgiLCJyZXF1ZXN0IiwicmVwbHkiLCJhZGRCb29sIiwibXV0YXRpb24iLCJuYW1lcyJdLCJtYXBwaW5ncyI6Ijs7QUFNQTs7QUFHQUEsbUJBQVNDLE1BQVQsQ0FBZ0I7QUFDZEMsRUFBQUEsUUFBUSxFQUFFLE1BREk7QUFFZEMsRUFBQUEsZUFBZSxFQUFFLDBCQUZIO0FBR2RDLEVBQUFBLFVBQVUsRUFBRSxZQUhFO0FBSWRDLEVBQUFBLFdBQVcsRUFBRSxTQUpDO0FBS2RDLEVBQUFBLE9BTGMsbUJBS05DLENBTE0sRUFLVztBQUN2QkEsSUFBQUEsQ0FBQyxDQUFDQyxVQUFGLEdBQWUsT0FBZjtBQUVBRCxJQUFBQSxDQUFDLENBQUNFLFlBQUYsQ0FBZUMsU0FBZixDQUF5QjtBQUN2QkMsTUFBQUEsYUFBYSxFQUFFLENBQUMsY0FBRCxFQUFpQixrQkFBakIsQ0FEUTtBQUV2QlQsTUFBQUEsUUFBUSxFQUFFO0FBRmEsS0FBekI7QUFLQUssSUFBQUEsQ0FBQyxDQUFDSyxNQUFGLENBQVNDLE9BQVQsQ0FBaUI7QUFDZkMsTUFBQUEsSUFB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QUUsZ0JBRndCO0FBRy9CVCxVQUFBQSxPQUgrQixtQkFHdkJVLENBSHVCLEVBR3BCO0FBQ1RBLFlBQUFBLENBQUMsQ0FBQ0UsUUFBRixHQUFhLElBQWI7QUFDRDtBQUw4QixTQUFqQztBQU9BRixRQUFBQSxDQUFDLENBQUNnQixPQUFGLENBQVVULFVBQVYsQ0FBcUJDLE9BQXJCLENBQTZCO0FBQzNCVixVQUFBQSxJQUFJLEVBQUUsY0FEcUI7QUFFM0JDLFVBQUFBLEtBQUssRUFBRSxpQ0FGb0I7QUFHM0JULFVBQUFBLE9BSDJCLG1CQUduQlUsQ0FIbUIsRUFHTjtBQUNuQkEsWUFBQUEsQ0FBQyxDQUFDRSxRQUFGLEdBQWEsSUFBYjtBQUNBRixZQUFBQSxDQUFDLENBQUNTLE1BQUYsR0FBVztBQUNUdkIsY0FBQUEsUUFBUSxFQUFFLE1BREQ7QUFFVGtDLGNBQUFBLEtBQUssRUFBRSxDQUFDLGNBQUQ7QUFGRSxhQUFYO0FBSUQ7QUFUMEIsU0FBN0I7QUFXQXBCLFFBQUFBLENBQUMsQ0FBQ2lCLEtBQUYsQ0FBUVYsVUFBUixDQUFtQkMsT0FBbkIsQ0FBMkI7QUFDekJWLFVBQUFBLElBQUksRUFBRSxNQURtQjtBQUV6QkMsVUFBQUEsS0FBSyxZQUFLUixDQUFDLENBQUNKLGVBQVAsVUFGb0I7QUFHekJHLFVBQUFBLE9BSHlCLG1CQUdqQlUsQ0FIaUIsRUFHSjtBQUNuQkEsWUFBQUEsQ0FBQyxDQUFDUyxNQUFGLEdBQVc7QUFDVHZCLGNBQUFBLFFBQVEsRUFBRTtBQURELGFBQVg7QUFHRDtBQVB3QixTQUEzQjtBQVNEO0FBckRpQixLQUFwQjtBQXVERDtBQXJLYSxDQUFoQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIFByb3BPYmplY3QsXG4gIFByb3BNZXRob2QsXG4gIFByb3BMaW5rLFxuICBQcm9wTnVtYmVyLFxufSBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9wcmVsdWRlXCI7XG5pbXBvcnQgeyByZWdpc3RyeSB9IGZyb20gXCIuLi8uLi9yZWdpc3RyeVwiO1xuaW1wb3J0IHsgU3lzdGVtT2JqZWN0IH0gZnJvbSBcIi4uLy4uL3N5c3RlbUNvbXBvbmVudFwiO1xuXG5yZWdpc3RyeS5zeXN0ZW0oe1xuICB0eXBlTmFtZTogXCJ1c2VyXCIsXG4gIGRpc3BsYXlUeXBlTmFtZTogXCJBIFN5c3RlbSBJbml0aWF0aXZlIFVzZXJcIixcbiAgc2lQYXRoTmFtZTogXCJzaS1hY2NvdW50XCIsXG4gIHNlcnZpY2VOYW1lOiBcImFjY291bnRcIixcbiAgb3B0aW9ucyhjOiBTeXN0ZW1PYmplY3QpIHtcbiAgICBjLm5hdHVyYWxLZXkgPSBcImVtYWlsXCI7XG5cbiAgICBjLmFzc29jaWF0aW9ucy5iZWxvbmdzVG8oe1xuICAgICAgZnJvbUZpZWxkUGF0aDogW1wic2lQcm9wZXJ0aWVzXCIsIFwiYmlsbGluZ0FjY291bnRJZFwiXSxcbiAgICAgIHR5cGVOYW1lOiBcImJpbGxpbmdBY2NvdW50XCIsXG4gICAgfSk7XG5cbiAgICBjLmZpZWxkcy5hZGRUZXh0KHtcbiAgICAgIG5hbWU6IFwiZW1haWxcIixcbiAgICAgIGxhYmVsOiBcIkEgdmFsaWQgZW1haWwgYWRkcmVzc1wiLFxuICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgIHAudW5pdmVyc2FsID0gdHJ1ZTtcbiAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICB9LFxuICAgIH0pO1xuICAgIGMuZmllbGRzLmFkZFBhc3N3b3JkKHtcbiAgICAgIG5hbWU6IFwicGFzc3dvcmRcIixcbiAgICAgIGxhYmVsOiBcIlRoZSB1c2VycyBwYXNzd29yZCBoYXNoXCIsXG4gICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgcC51bml2ZXJzYWwgPSB0cnVlO1xuICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgcC5oaWRkZW4gPSB0cnVlO1xuICAgICAgICBwLnNraXAgPSB0cnVlO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICBjLmZpZWxkcy5hZGRPYmplY3Qoe1xuICAgICAgbmFtZTogXCJzaVByb3BlcnRpZXNcIixcbiAgICAgIGxhYmVsOiBcIlNJIEludGVybmFsIFByb3BlcnRpZXNcIixcbiAgICAgIG9wdGlvbnMocDogUHJvcE9iamVjdCkge1xuICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiYmlsbGluZ0FjY291bnRJZFwiLFxuICAgICAgICAgIGxhYmVsOiBcIkJpbGxpbmcgQWNjb3VudCBJRFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0pO1xuICAgIGMuZmllbGRzLmFkZExpbmsoe1xuICAgICAgbmFtZTogXCJjYXBhYmlsaXRpZXNcIixcbiAgICAgIGxhYmVsOiBcIkF1dGhvcml6ZWQgY2FwYWJpbGl0aWVzIGZvciB0aGlzIHVzZXJcIixcbiAgICAgIG9wdGlvbnMocDogUHJvcExpbmspIHtcbiAgICAgICAgcC5oaWRkZW4gPSB0cnVlO1xuICAgICAgICBwLmxvb2t1cCA9IHtcbiAgICAgICAgICB0eXBlTmFtZTogXCJjYXBhYmlsaXR5XCIsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgYy5hZGRMaXN0TWV0aG9kKCk7XG4gICAgYy5hZGRHZXRNZXRob2QoKTtcblxuICAgIGMubWV0aG9kcy5hZGRNZXRob2Qoe1xuICAgICAgbmFtZTogXCJsb2dpbkludGVybmFsXCIsXG4gICAgICBsYWJlbDogXCJMb2dpblwiLFxuICAgICAgb3B0aW9ucyhwOiBQcm9wTWV0aG9kKSB7XG4gICAgICAgIHAuaXNQcml2YXRlID0gdHJ1ZTtcbiAgICAgICAgcC5za2lwQXV0aCA9IHRydWU7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiZW1haWxcIixcbiAgICAgICAgICBsYWJlbDogXCJFbWFpbFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZFBhc3N3b3JkKHtcbiAgICAgICAgICBuYW1lOiBcInBhc3N3b3JkXCIsXG4gICAgICAgICAgbGFiZWw6IFwiUGFzc3dvcmRcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImJpbGxpbmdBY2NvdW50TmFtZVwiLFxuICAgICAgICAgIGxhYmVsOiBcIkJpbGxpbmcgQWNjb3VudFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVwbHkucHJvcGVydGllcy5hZGRCb29sKHtcbiAgICAgICAgICBuYW1lOiBcImF1dGhlbnRpY2F0ZWRcIixcbiAgICAgICAgICBsYWJlbDogXCJBdXRoZW50aWNhdGVkXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXBseS5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwidXNlcklkXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVXNlciBJZFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVwbHkucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImJpbGxpbmdBY2NvdW50SWRcIixcbiAgICAgICAgICBsYWJlbDogXCJCaWxsaW5nIEFjY291bnQgSWRcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGMubWV0aG9kcy5hZGRNZXRob2Qoe1xuICAgICAgbmFtZTogXCJjcmVhdGVcIixcbiAgICAgIGxhYmVsOiBcIkNyZWF0ZSBhIFVzZXJcIixcbiAgICAgIG9wdGlvbnMocDogUHJvcE1ldGhvZCkge1xuICAgICAgICBwLm11dGF0aW9uID0gdHJ1ZTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJuYW1lXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVXNlciBOYW1lXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJkaXNwbGF5TmFtZVwiLFxuICAgICAgICAgIGxhYmVsOiBcIlVzZXIgRGlzcGxheSBOYW1lXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJlbWFpbFwiLFxuICAgICAgICAgIGxhYmVsOiBcIlVzZXJzIGVtYWlsIGFkZHJlc3NcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRQYXNzd29yZCh7XG4gICAgICAgICAgbmFtZTogXCJwYXNzd29yZFwiLFxuICAgICAgICAgIGxhYmVsOiBcIlVzZXJzIHBhc3N3b3JkXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkTGluayh7XG4gICAgICAgICAgbmFtZTogXCJzaVByb3BlcnRpZXNcIixcbiAgICAgICAgICBsYWJlbDogXCJUaGUgU0kgUHJvcGVydGllcyBmb3IgdGhpcyBVc2VyXCIsXG4gICAgICAgICAgb3B0aW9ucyhwOiBQcm9wTGluaykge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgICBwLmxvb2t1cCA9IHtcbiAgICAgICAgICAgICAgdHlwZU5hbWU6IFwidXNlclwiLFxuICAgICAgICAgICAgICBuYW1lczogW1wic2lQcm9wZXJ0aWVzXCJdLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXBseS5wcm9wZXJ0aWVzLmFkZExpbmsoe1xuICAgICAgICAgIG5hbWU6IFwiaXRlbVwiLFxuICAgICAgICAgIGxhYmVsOiBgJHtjLmRpc3BsYXlUeXBlTmFtZX0gSXRlbWAsXG4gICAgICAgICAgb3B0aW9ucyhwOiBQcm9wTGluaykge1xuICAgICAgICAgICAgcC5sb29rdXAgPSB7XG4gICAgICAgICAgICAgIHR5cGVOYW1lOiBcInVzZXJcIixcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0pO1xuICB9LFxufSk7XG4iXX0=