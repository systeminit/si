"use strict";

var _registry = require("../../registry");

_registry.registry.system({
  typeName: "user",
  displayTypeName: "A System Initiative User",
  siPathName: "si-account",
  serviceName: "account",
  options: function options(c) {
    c.naturalKey = "email";
    c.associations.belongsTo({
      fromFieldPath: ["siProperties", "billingAccountId"],
      typeName: "billingAccount"
    });
    c.fields.addText({
      name: "email",
      label: "A valid email address",
      options: function options(p) {
        p.universal = true;
        p.required = true;
      }
    });
    c.fields.addPassword({
      name: "password",
      label: "The users password hash",
      options: function options(p) {
        p.universal = true;
        p.required = true;
        p.hidden = true;
        p.skip = true;
      }
    });
    c.fields.addObject({
      name: "siProperties",
      label: "SI Internal Properties",
      options: function options(p) {
        p.required = true;
        p.properties.addText({
          name: "billingAccountId",
          label: "Billing Account ID",
          options: function options(p) {
            p.required = true;
          }
        });
        p.properties.addNumber({
          name: "currentTxn",
          label: "The users current transaction id (128 bit integer)",
          options: function options(p) {
            p.numberKind = "u128";
          }
        });
      }
    });
    c.fields.addLink({
      name: "capabilities",
      label: "Authorized capabilities for this user",
      options: function options(p) {
        p.hidden = true;
        p.lookup = {
          typeName: "capability"
        };
      }
    });
    c.addListMethod();
    c.addGetMethod();
    c.methods.addMethod({
      name: "loginInternal",
      label: "Login",
      options: function options(p) {
        p.isPrivate = true;
        p.skipAuth = true;
        p.request.properties.addText({
          name: "email",
          label: "Email",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addPassword({
          name: "password",
          label: "Password",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "billingAccountName",
          label: "Billing Account",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addBool({
          name: "authenticated",
          label: "Authenticated",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addText({
          name: "userId",
          label: "User Id",
          options: function options(p) {
            p.required = true;
          }
        });
        p.reply.properties.addText({
          name: "billingAccountId",
          label: "Billing Account Id",
          options: function options(p) {
            p.required = true;
          }
        });
      }
    });
    c.methods.addMethod({
      name: "create",
      label: "Create a User",
      options: function options(p) {
        p.mutation = true;
        p.request.properties.addText({
          name: "name",
          label: "User Name",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "displayName",
          label: "User Display Name",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addText({
          name: "email",
          label: "Users email address",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addPassword({
          name: "password",
          label: "Users password",
          options: function options(p) {
            p.required = true;
          }
        });
        p.request.properties.addLink({
          name: "siProperties",
          label: "The SI Properties for this User",
          options: function options(p) {
            p.required = true;
            p.lookup = {
              typeName: "user",
              names: ["siProperties"]
            };
          }
        });
        p.reply.properties.addLink({
          name: "item",
          label: "".concat(c.displayTypeName, " Item"),
          options: function options(p) {
            p.lookup = {
              typeName: "user"
            };
          }
        });
      }
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3NpLWFjY291bnQvdXNlci50cyJdLCJuYW1lcyI6WyJyZWdpc3RyeSIsInN5c3RlbSIsInR5cGVOYW1lIiwiZGlzcGxheVR5cGVOYW1lIiwic2lQYXRoTmFtZSIsInNlcnZpY2VOYW1lIiwib3B0aW9ucyIsImMiLCJuYXR1cmFsS2V5IiwiYXNzb2NpYXRpb25zIiwiYmVsb25nc1RvIiwiZnJvbUZpZWxkUGF0aCIsImZpZWxkcyIsImFkZFRleHQiLCJuYW1lIiwibGFiZWwiLCJwIiwidW5pdmVyc2FsIiwicmVxdWlyZWQiLCJhZGRQYXNzd29yZCIsImhpZGRlbiIsInNraXAiLCJhZGRPYmplY3QiLCJwcm9wZXJ0aWVzIiwiYWRkTnVtYmVyIiwibnVtYmVyS2luZCIsImFkZExpbmsiLCJsb29rdXAiLCJhZGRMaXN0TWV0aG9kIiwiYWRkR2V0TWV0aG9kIiwibWV0aG9kcyIsImFkZE1ldGhvZCIsImlzUHJpdmF0ZSIsInNraXBBdXRoIiwicmVxdWVzdCIsInJlcGx5IiwiYWRkQm9vbCIsIm11dGF0aW9uIiwibmFtZXMiXSwibWFwcGluZ3MiOiI7O0FBTUE7O0FBR0FBLG1CQUFTQyxNQUFULENBQWdCO0FBQ2RDLEVBQUFBLFFBQVEsRUFBRSxNQURJO0FBRWRDLEVBQUFBLGVBQWUsRUFBRSwwQkFGSDtBQUdkQyxFQUFBQSxVQUFVLEVBQUUsWUFIRTtBQUlkQyxFQUFBQSxXQUFXLEVBQUUsU0FKQztBQUtkQyxFQUFBQSxPQUxjLG1CQUtOQyxDQUxNLEVBS1c7QUFDdkJBLElBQUFBLENBQUMsQ0FBQ0MsVUFBRixHQUFlLE9BQWY7QUFFQUQsSUFBQUEsQ0FBQyxDQUFDRSxZQUFGLENBQWVDLFNBQWYsQ0FBeUI7QUFDdkJDLE1BQUFBLGFBQWEsRUFBRSxDQUFDLGNBQUQsRUFBaUIsa0JBQWpCLENBRFE7QUFFdkJULE1BQUFBLFFBQVEsRUFBRTtBQUZhLEtBQXpCO0FBS0FLLElBQUFBLENBQUMsQ0FBQ0ssTUFBRixDQUFTQyxP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QUEzQjtBQVNEO0FBckRpQixLQUFwQjtBQXVERDtBQTVLYSxDQUFoQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIFByb3BPYmplY3QsXG4gIFByb3BNZXRob2QsXG4gIFByb3BMaW5rLFxuICBQcm9wTnVtYmVyLFxufSBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9wcmVsdWRlXCI7XG5pbXBvcnQgeyByZWdpc3RyeSB9IGZyb20gXCIuLi8uLi9yZWdpc3RyeVwiO1xuaW1wb3J0IHsgU3lzdGVtT2JqZWN0IH0gZnJvbSBcIi4uLy4uL3N5c3RlbUNvbXBvbmVudFwiO1xuXG5yZWdpc3RyeS5zeXN0ZW0oe1xuICB0eXBlTmFtZTogXCJ1c2VyXCIsXG4gIGRpc3BsYXlUeXBlTmFtZTogXCJBIFN5c3RlbSBJbml0aWF0aXZlIFVzZXJcIixcbiAgc2lQYXRoTmFtZTogXCJzaS1hY2NvdW50XCIsXG4gIHNlcnZpY2VOYW1lOiBcImFjY291bnRcIixcbiAgb3B0aW9ucyhjOiBTeXN0ZW1PYmplY3QpIHtcbiAgICBjLm5hdHVyYWxLZXkgPSBcImVtYWlsXCI7XG5cbiAgICBjLmFzc29jaWF0aW9ucy5iZWxvbmdzVG8oe1xuICAgICAgZnJvbUZpZWxkUGF0aDogW1wic2lQcm9wZXJ0aWVzXCIsIFwiYmlsbGluZ0FjY291bnRJZFwiXSxcbiAgICAgIHR5cGVOYW1lOiBcImJpbGxpbmdBY2NvdW50XCIsXG4gICAgfSk7XG5cbiAgICBjLmZpZWxkcy5hZGRUZXh0KHtcbiAgICAgIG5hbWU6IFwiZW1haWxcIixcbiAgICAgIGxhYmVsOiBcIkEgdmFsaWQgZW1haWwgYWRkcmVzc1wiLFxuICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgIHAudW5pdmVyc2FsID0gdHJ1ZTtcbiAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICB9LFxuICAgIH0pO1xuICAgIGMuZmllbGRzLmFkZFBhc3N3b3JkKHtcbiAgICAgIG5hbWU6IFwicGFzc3dvcmRcIixcbiAgICAgIGxhYmVsOiBcIlRoZSB1c2VycyBwYXNzd29yZCBoYXNoXCIsXG4gICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgcC51bml2ZXJzYWwgPSB0cnVlO1xuICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgcC5oaWRkZW4gPSB0cnVlO1xuICAgICAgICBwLnNraXAgPSB0cnVlO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICBjLmZpZWxkcy5hZGRPYmplY3Qoe1xuICAgICAgbmFtZTogXCJzaVByb3BlcnRpZXNcIixcbiAgICAgIGxhYmVsOiBcIlNJIEludGVybmFsIFByb3BlcnRpZXNcIixcbiAgICAgIG9wdGlvbnMocDogUHJvcE9iamVjdCkge1xuICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgcC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiYmlsbGluZ0FjY291bnRJZFwiLFxuICAgICAgICAgIGxhYmVsOiBcIkJpbGxpbmcgQWNjb3VudCBJRFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucHJvcGVydGllcy5hZGROdW1iZXIoe1xuICAgICAgICAgIG5hbWU6IFwiY3VycmVudFR4blwiLFxuICAgICAgICAgIGxhYmVsOiBcIlRoZSB1c2VycyBjdXJyZW50IHRyYW5zYWN0aW9uIGlkICgxMjggYml0IGludGVnZXIpXCIsXG4gICAgICAgICAgb3B0aW9ucyhwOiBQcm9wTnVtYmVyKSB7XG4gICAgICAgICAgICBwLm51bWJlcktpbmQgPSBcInUxMjhcIjtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgYy5maWVsZHMuYWRkTGluayh7XG4gICAgICBuYW1lOiBcImNhcGFiaWxpdGllc1wiLFxuICAgICAgbGFiZWw6IFwiQXV0aG9yaXplZCBjYXBhYmlsaXRpZXMgZm9yIHRoaXMgdXNlclwiLFxuICAgICAgb3B0aW9ucyhwOiBQcm9wTGluaykge1xuICAgICAgICBwLmhpZGRlbiA9IHRydWU7XG4gICAgICAgIHAubG9va3VwID0ge1xuICAgICAgICAgIHR5cGVOYW1lOiBcImNhcGFiaWxpdHlcIixcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjLmFkZExpc3RNZXRob2QoKTtcbiAgICBjLmFkZEdldE1ldGhvZCgpO1xuXG4gICAgYy5tZXRob2RzLmFkZE1ldGhvZCh7XG4gICAgICBuYW1lOiBcImxvZ2luSW50ZXJuYWxcIixcbiAgICAgIGxhYmVsOiBcIkxvZ2luXCIsXG4gICAgICBvcHRpb25zKHA6IFByb3BNZXRob2QpIHtcbiAgICAgICAgcC5pc1ByaXZhdGUgPSB0cnVlO1xuICAgICAgICBwLnNraXBBdXRoID0gdHJ1ZTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJlbWFpbFwiLFxuICAgICAgICAgIGxhYmVsOiBcIkVtYWlsXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXF1ZXN0LnByb3BlcnRpZXMuYWRkUGFzc3dvcmQoe1xuICAgICAgICAgIG5hbWU6IFwicGFzc3dvcmRcIixcbiAgICAgICAgICBsYWJlbDogXCJQYXNzd29yZFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiYmlsbGluZ0FjY291bnROYW1lXCIsXG4gICAgICAgICAgbGFiZWw6IFwiQmlsbGluZyBBY2NvdW50XCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXBseS5wcm9wZXJ0aWVzLmFkZEJvb2woe1xuICAgICAgICAgIG5hbWU6IFwiYXV0aGVudGljYXRlZFwiLFxuICAgICAgICAgIGxhYmVsOiBcIkF1dGhlbnRpY2F0ZWRcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcGx5LnByb3BlcnRpZXMuYWRkVGV4dCh7XG4gICAgICAgICAgbmFtZTogXCJ1c2VySWRcIixcbiAgICAgICAgICBsYWJlbDogXCJVc2VyIElkXCIsXG4gICAgICAgICAgb3B0aW9ucyhwKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcC5yZXBseS5wcm9wZXJ0aWVzLmFkZFRleHQoe1xuICAgICAgICAgIG5hbWU6IFwiYmlsbGluZ0FjY291bnRJZFwiLFxuICAgICAgICAgIGxhYmVsOiBcIkJpbGxpbmcgQWNjb3VudCBJZFwiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgYy5tZXRob2RzLmFkZE1ldGhvZCh7XG4gICAgICBuYW1lOiBcImNyZWF0ZVwiLFxuICAgICAgbGFiZWw6IFwiQ3JlYXRlIGEgVXNlclwiLFxuICAgICAgb3B0aW9ucyhwOiBQcm9wTWV0aG9kKSB7XG4gICAgICAgIHAubXV0YXRpb24gPSB0cnVlO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcIm5hbWVcIixcbiAgICAgICAgICBsYWJlbDogXCJVc2VyIE5hbWVcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImRpc3BsYXlOYW1lXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVXNlciBEaXNwbGF5IE5hbWVcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRUZXh0KHtcbiAgICAgICAgICBuYW1lOiBcImVtYWlsXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVXNlcnMgZW1haWwgYWRkcmVzc1wiLFxuICAgICAgICAgIG9wdGlvbnMocCkge1xuICAgICAgICAgICAgcC5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHAucmVxdWVzdC5wcm9wZXJ0aWVzLmFkZFBhc3N3b3JkKHtcbiAgICAgICAgICBuYW1lOiBcInBhc3N3b3JkXCIsXG4gICAgICAgICAgbGFiZWw6IFwiVXNlcnMgcGFzc3dvcmRcIixcbiAgICAgICAgICBvcHRpb25zKHApIHtcbiAgICAgICAgICAgIHAucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcXVlc3QucHJvcGVydGllcy5hZGRMaW5rKHtcbiAgICAgICAgICBuYW1lOiBcInNpUHJvcGVydGllc1wiLFxuICAgICAgICAgIGxhYmVsOiBcIlRoZSBTSSBQcm9wZXJ0aWVzIGZvciB0aGlzIFVzZXJcIixcbiAgICAgICAgICBvcHRpb25zKHA6IFByb3BMaW5rKSB7XG4gICAgICAgICAgICBwLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHAubG9va3VwID0ge1xuICAgICAgICAgICAgICB0eXBlTmFtZTogXCJ1c2VyXCIsXG4gICAgICAgICAgICAgIG5hbWVzOiBbXCJzaVByb3BlcnRpZXNcIl0sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBwLnJlcGx5LnByb3BlcnRpZXMuYWRkTGluayh7XG4gICAgICAgICAgbmFtZTogXCJpdGVtXCIsXG4gICAgICAgICAgbGFiZWw6IGAke2MuZGlzcGxheVR5cGVOYW1lfSBJdGVtYCxcbiAgICAgICAgICBvcHRpb25zKHA6IFByb3BMaW5rKSB7XG4gICAgICAgICAgICBwLmxvb2t1cCA9IHtcbiAgICAgICAgICAgICAgdHlwZU5hbWU6IFwidXNlclwiLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0sXG59KTtcbiJdfQ==