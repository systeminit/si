<%- fmt.implServiceAuth(propMethod) %>

let user_id = request
    .metadata()
    .get("userid")
    .map(|r| r.to_str().unwrap_or("no_user_id_bug_live_here")).unwrap().to_string();

let inner = request.into_inner();
let id = inner
    .id
    .ok_or_else(|| si_data::DataError::RequiredField("id".to_string()))?;

let mut entity = <%- fmt.structName() %>::get(&self.db, &id).await?;

entity.delete(&self.db, inner.change_set_id, inner.edit_session_id).await?;

si_account::EventLog::entity_delete(&self.db, &user_id, &entity).await?; 

Ok(tonic::Response::new(
  <%- fmt.implServiceReplyType(propMethod, { option: false, reference: false }) %> { item: Some(entity) },
))
