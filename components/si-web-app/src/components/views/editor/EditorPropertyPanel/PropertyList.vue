<template>
  <div id="property-panel-list" class="w-full h-full">
    
    <PropObject
      :propObject="kubernetesDeploymentEntityCreate.request"
      :propObjectModel="kubernetesDeploymentEntityCreateVars"
      @propChangeMsg="propChangeMsg"
    />

    <div class="flex flex-row-reverse pr-8 pb-4">
      <button class="bg-teal-700 px-4 py-2 text-white hover:bg-teal-600" @click="createEntity()" type="button">
        Create
      </button>
    </div>
  </div>
</template>

<script>
import { registry } from "si-registry";
import { auth } from "@/utils/auth";

import PropObject from "./PropObject.vue";

export default {
  name: "PropertyList",
  components: {
    //LinkIcon,
    PropObject,
  },
  mounted() {},
  data() {
    const kubernetesDeploymentEntity = registry.get(
      "kubernetesDeploymentEntity",
    );
    const kubernetesDeploymentEntityCreate = kubernetesDeploymentEntity.methods.getEntry(
      "create",
    );

    const kubernetesDeploymentEntityCreateVars = kubernetesDeploymentEntity.graphql.variablesObject(
      { methodName: "create" },
    );
    console.log(kubernetesDeploymentEntityCreateVars);

    return {
      kubernetesDeploymentEntity,
      kubernetesDeploymentEntityCreate,
      kubernetesDeploymentEntityCreateVars,
    };
  },
  methods: {
    propChangeMsg(event) {
      this.kubernetesDeploymentEntityCreateVars = event["value"];
    },
    createEntity() {
      const mutation = this.kubernetesDeploymentEntity.graphql.mutation({
        methodName: "create",
      });
      console.log(mutation);

      try {
        this.$apollo.mutate({
          mutation,
          variables: {
            name: this.kubernetesDeploymentEntityCreateVars.name,
            displayName: this.kubernetesDeploymentEntityCreateVars.displayName,
            description: this.kubernetesDeploymentEntityCreateVars.description,
            workspaceId: auth.getProfile().workspaceDefault.id,
            properties: {
              kubernetesObject: {
                kind: "your butt",
                apiVersion: "1.0",
              },
            },
            constraints: {
              kubernetesVersion: "V1_15",
            },
          },
        });
      } catch (error) {
        console.log("not today, homie", { error });
      }

      try {
        consol.log(this.kubernetesDeploymentEntityList);
        // let objE = registry.objects
        // let listTest = this.kubernetesDeploymentEntityList()

        // let KubernetesDeploymentEntityListRequest = registry.KubernetesDeploymentEntityListRequest()
        // let KubernetesDeploymentEntityList = this.kubernetesDeploymentEntity.methods.getEntry("list");

        // let KubernetesDeploymentEntityList = registry.KubernetesDeploymentEntityListKubernetesDeploymentEntityListRequest)
        // let listA = registry.get("kubernetesDeploymentEntityList", );
        // console.log(KubernetesDeploymentEntityList)
      } catch (error) {
        console.log("oops", { error });
      }

      console.log("done");
    },
    onKeyUp(event) {
      if (event.key == "Enter") {
        console.log("Enter was pressed");
        console.log(event);
        console.log(event.target);
        console.log(event.target["aria-label"]);
      }
    },
  },
  apollo: {
    kubernetesDeploymentEntityList: {
      query() {
        return this.kubernetesDeploymentEntity.graphql.query({
          methodName: "list",
        });
      },
      variables() {
        return {
          pageSize: "1000",
        };
      },
      update(data) {
        console.log(data);
        console.log(data.kubernetesDeploymentEntityList);
      },
    },
    // kubernetesDeploymentEntityGet: {
    //   query() {
    //     return this.kubernetesDeploymentEntity.graphql.query({
    //       methodName:"get"
    //     });
    //   },
    //   variables(myVar) {
    //     return {
    //       pageSize: myVar
    //     }
    //   },
    //   update(data) {
    //     console.log(data)
    //     // this.me == data.what.I.want
    //   }
    // }
    // -> Item List... look into our item list
  },
};
</script>

<style>
.property-editor-bg-color {
  background-color: #212324;
}

.input-bg-color {
  background-color: #25788a;
}
</style>
