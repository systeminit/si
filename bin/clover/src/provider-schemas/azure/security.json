{
  "swagger": "2.0",
  "info": {
    "title": "Azure security",
    "version": "2025-06-01",
    "description": "Azure security service specifications"
  },
  "host": "management.azure.com",
  "schemes": [
    "https"
  ],
  "paths": {
    "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{settingName}": {
      "get": {
        "tags": [
          "DefenderForStorage"
        ],
        "description": "Gets the Defender for Storage settings for the specified storage account.",
        "operationId": "DefenderForStorage_Get",
        "parameters": [
          {
            "name": "api-version",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "API version for the operation"
          },
          {
            "name": "resourceId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "The identifier of the resource.",
            "x-ms-parameter-location": "method",
            "x-ms-skip-url-encoding": true
          },
          {
            "name": "settingName",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "^[a-z][a-z0-9]*$",
            "enum": [
              "current"
            ],
            "x-ms-enum": {
              "name": "settingName",
              "modelAsString": true,
              "values": [
                {
                  "value": "current",
                  "description": "Name of the Defender for Storage Settings name."
                }
              ]
            },
            "description": "Defender for Storage setting name.",
            "x-ms-parameter-location": "method"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful request to get Defender for Storage settings.",
            "schema": {
              "type": "object",
              "properties": {
                "id": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource Id"
                },
                "name": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource name"
                },
                "type": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource type"
                },
                "properties": {
                  "type": "object",
                  "properties": {
                    "isEnabled": {
                      "type": "boolean",
                      "description": "Indicates whether Defender for Storage is enabled on this storage account."
                    },
                    "malwareScanning": {
                      "type": "object",
                      "properties": {
                        "onUpload": {
                          "type": "object",
                          "properties": {
                            "isEnabled": {
                              "type": "boolean",
                              "description": "Indicates whether On Upload malware scanning should be enabled."
                            },
                            "capGBPerMonth": {
                              "type": "integer",
                              "format": "int32",
                              "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
                            },
                            "filters": {
                              "x-nullable": true,
                              "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
                              "type": "object",
                              "properties": {
                                "excludeBlobsWithPrefix": {
                                  "type": "array",
                                  "x-nullable": true,
                                  "items": {
                                    "type": "string"
                                  },
                                  "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
                                },
                                "excludeBlobsWithSuffix": {
                                  "type": "array",
                                  "x-nullable": true,
                                  "items": {
                                    "type": "string"
                                  },
                                  "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
                                },
                                "excludeBlobsLargerThan": {
                                  "format": "int64",
                                  "x-nullable": true,
                                  "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
                                }
                              }
                            }
                          },
                          "description": "Properties of On Upload malware scanning."
                        },
                        "scanResultsEventGridTopicResourceId": {
                          "type": "string",
                          "description": "Optional. Resource id of an Event Grid Topic to send scan results to."
                        },
                        "blobScanResultsOptions": {
                          "type": "string",
                          "description": "Optional. Write scan result on blobIndexTags by default.",
                          "enum": [
                            "blobIndexTags",
                            "None"
                          ],
                          "x-ms-enum": {
                            "name": "blobScanResultsOptions",
                            "modelAsString": true,
                            "values": [
                              {
                                "value": "blobIndexTags",
                                "description": "Write scan results on the blobs index tags."
                              },
                              {
                                "value": "None",
                                "description": "Do not write scan results on the blobs index tags."
                              }
                            ]
                          }
                        },
                        "operationStatus": {
                          "type": "object",
                          "readOnly": true,
                          "description": "Upon failure or partial success. Additional data describing Malware Scanning enable/disable operation.",
                          "properties": {
                            "code": {
                              "type": "string",
                              "description": "The operation status code."
                            },
                            "message": {
                              "type": "string",
                              "description": "Additional information regarding the success/failure of the operation."
                            }
                          }
                        }
                      },
                      "description": "Properties of Malware Scanning."
                    },
                    "sensitiveDataDiscovery": {
                      "type": "object",
                      "properties": {
                        "isEnabled": {
                          "type": "boolean",
                          "description": "Indicates whether Sensitive Data Discovery should be enabled."
                        },
                        "operationStatus": {
                          "type": "object",
                          "readOnly": true,
                          "description": "Upon failure or partial success. Additional data describing Sensitive Data Discovery enable/disable operation.",
                          "properties": {
                            "code": {
                              "type": "string",
                              "description": "The operation status code."
                            },
                            "message": {
                              "type": "string",
                              "description": "Additional information regarding the success/failure of the operation."
                            }
                          }
                        }
                      },
                      "description": "Properties of Sensitive Data Discovery."
                    },
                    "overrideSubscriptionLevelSettings": {
                      "type": "boolean",
                      "description": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."
                    }
                  },
                  "description": "Defender for Storage resource properties."
                }
              },
              "description": "The Defender for Storage resource."
            }
          }
        }
      },
      "put": {
        "tags": [
          "DefenderForStorage"
        ],
        "description": "Creates or updates the Defender for Storage settings on a specified storage account.",
        "operationId": "DefenderForStorage_Create",
        "parameters": [
          {
            "name": "api-version",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "API version for the operation"
          },
          {
            "name": "resourceId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "The identifier of the resource.",
            "x-ms-parameter-location": "method",
            "x-ms-skip-url-encoding": true
          },
          {
            "name": "settingName",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "^[a-z][a-z0-9]*$",
            "enum": [
              "current"
            ],
            "x-ms-enum": {
              "name": "settingName",
              "modelAsString": true,
              "values": [
                {
                  "value": "current",
                  "description": "Name of the Defender for Storage Settings name."
                }
              ]
            },
            "description": "Defender for Storage setting name.",
            "x-ms-parameter-location": "method"
          },
          {
            "name": "defenderForStorageSetting",
            "in": "body",
            "required": true,
            "description": "Defender for Storage Settings",
            "schema": {
              "type": "object",
              "properties": {
                "id": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource Id"
                },
                "name": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource name"
                },
                "type": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource type"
                },
                "properties": {
                  "type": "object",
                  "properties": {
                    "isEnabled": {
                      "type": "boolean",
                      "description": "Indicates whether Defender for Storage is enabled on this storage account."
                    },
                    "malwareScanning": {
                      "type": "object",
                      "properties": {
                        "onUpload": {
                          "type": "object",
                          "properties": {
                            "isEnabled": {
                              "type": "boolean",
                              "description": "Indicates whether On Upload malware scanning should be enabled."
                            },
                            "capGBPerMonth": {
                              "type": "integer",
                              "format": "int32",
                              "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
                            },
                            "filters": {
                              "x-nullable": true,
                              "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
                              "type": "object",
                              "properties": {
                                "excludeBlobsWithPrefix": {
                                  "type": "array",
                                  "x-nullable": true,
                                  "items": {
                                    "type": "string"
                                  },
                                  "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
                                },
                                "excludeBlobsWithSuffix": {
                                  "type": "array",
                                  "x-nullable": true,
                                  "items": {
                                    "type": "string"
                                  },
                                  "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
                                },
                                "excludeBlobsLargerThan": {
                                  "format": "int64",
                                  "x-nullable": true,
                                  "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
                                }
                              }
                            }
                          },
                          "description": "Properties of On Upload malware scanning."
                        },
                        "scanResultsEventGridTopicResourceId": {
                          "type": "string",
                          "description": "Optional. Resource id of an Event Grid Topic to send scan results to."
                        },
                        "blobScanResultsOptions": {
                          "type": "string",
                          "description": "Optional. Write scan result on blobIndexTags by default.",
                          "enum": [
                            "blobIndexTags",
                            "None"
                          ],
                          "x-ms-enum": {
                            "name": "blobScanResultsOptions",
                            "modelAsString": true,
                            "values": [
                              {
                                "value": "blobIndexTags",
                                "description": "Write scan results on the blobs index tags."
                              },
                              {
                                "value": "None",
                                "description": "Do not write scan results on the blobs index tags."
                              }
                            ]
                          }
                        },
                        "operationStatus": {
                          "type": "object",
                          "readOnly": true,
                          "description": "Upon failure or partial success. Additional data describing Malware Scanning enable/disable operation.",
                          "properties": {
                            "code": {
                              "type": "string",
                              "description": "The operation status code."
                            },
                            "message": {
                              "type": "string",
                              "description": "Additional information regarding the success/failure of the operation."
                            }
                          }
                        }
                      },
                      "description": "Properties of Malware Scanning."
                    },
                    "sensitiveDataDiscovery": {
                      "type": "object",
                      "properties": {
                        "isEnabled": {
                          "type": "boolean",
                          "description": "Indicates whether Sensitive Data Discovery should be enabled."
                        },
                        "operationStatus": {
                          "type": "object",
                          "readOnly": true,
                          "description": "Upon failure or partial success. Additional data describing Sensitive Data Discovery enable/disable operation.",
                          "properties": {
                            "code": {
                              "type": "string",
                              "description": "The operation status code."
                            },
                            "message": {
                              "type": "string",
                              "description": "Additional information regarding the success/failure of the operation."
                            }
                          }
                        }
                      },
                      "description": "Properties of Sensitive Data Discovery."
                    },
                    "overrideSubscriptionLevelSettings": {
                      "type": "boolean",
                      "description": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."
                    }
                  },
                  "description": "Defender for Storage resource properties."
                }
              },
              "description": "The Defender for Storage resource."
            },
            "x-ms-parameter-location": "method"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful request to create or update Defender for Storage settings.",
            "schema": {
              "type": "object",
              "properties": {
                "id": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource Id"
                },
                "name": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource name"
                },
                "type": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource type"
                },
                "properties": {
                  "type": "object",
                  "properties": {
                    "isEnabled": {
                      "type": "boolean",
                      "description": "Indicates whether Defender for Storage is enabled on this storage account."
                    },
                    "malwareScanning": {
                      "type": "object",
                      "properties": {
                        "onUpload": {
                          "type": "object",
                          "properties": {
                            "isEnabled": {
                              "type": "boolean",
                              "description": "Indicates whether On Upload malware scanning should be enabled."
                            },
                            "capGBPerMonth": {
                              "type": "integer",
                              "format": "int32",
                              "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
                            },
                            "filters": {
                              "x-nullable": true,
                              "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
                              "type": "object",
                              "properties": {
                                "excludeBlobsWithPrefix": {
                                  "type": "array",
                                  "x-nullable": true,
                                  "items": {
                                    "type": "string"
                                  },
                                  "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
                                },
                                "excludeBlobsWithSuffix": {
                                  "type": "array",
                                  "x-nullable": true,
                                  "items": {
                                    "type": "string"
                                  },
                                  "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
                                },
                                "excludeBlobsLargerThan": {
                                  "format": "int64",
                                  "x-nullable": true,
                                  "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
                                }
                              }
                            }
                          },
                          "description": "Properties of On Upload malware scanning."
                        },
                        "scanResultsEventGridTopicResourceId": {
                          "type": "string",
                          "description": "Optional. Resource id of an Event Grid Topic to send scan results to."
                        },
                        "blobScanResultsOptions": {
                          "type": "string",
                          "description": "Optional. Write scan result on blobIndexTags by default.",
                          "enum": [
                            "blobIndexTags",
                            "None"
                          ],
                          "x-ms-enum": {
                            "name": "blobScanResultsOptions",
                            "modelAsString": true,
                            "values": [
                              {
                                "value": "blobIndexTags",
                                "description": "Write scan results on the blobs index tags."
                              },
                              {
                                "value": "None",
                                "description": "Do not write scan results on the blobs index tags."
                              }
                            ]
                          }
                        },
                        "operationStatus": {
                          "type": "object",
                          "readOnly": true,
                          "description": "Upon failure or partial success. Additional data describing Malware Scanning enable/disable operation.",
                          "properties": {
                            "code": {
                              "type": "string",
                              "description": "The operation status code."
                            },
                            "message": {
                              "type": "string",
                              "description": "Additional information regarding the success/failure of the operation."
                            }
                          }
                        }
                      },
                      "description": "Properties of Malware Scanning."
                    },
                    "sensitiveDataDiscovery": {
                      "type": "object",
                      "properties": {
                        "isEnabled": {
                          "type": "boolean",
                          "description": "Indicates whether Sensitive Data Discovery should be enabled."
                        },
                        "operationStatus": {
                          "type": "object",
                          "readOnly": true,
                          "description": "Upon failure or partial success. Additional data describing Sensitive Data Discovery enable/disable operation.",
                          "properties": {
                            "code": {
                              "type": "string",
                              "description": "The operation status code."
                            },
                            "message": {
                              "type": "string",
                              "description": "Additional information regarding the success/failure of the operation."
                            }
                          }
                        }
                      },
                      "description": "Properties of Sensitive Data Discovery."
                    },
                    "overrideSubscriptionLevelSettings": {
                      "type": "boolean",
                      "description": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."
                    }
                  },
                  "description": "Defender for Storage resource properties."
                }
              },
              "description": "The Defender for Storage resource."
            }
          },
          "201": {
            "description": "Request to  create or update Defender for Storage settings partially succeeded.",
            "schema": {
              "type": "object",
              "properties": {
                "id": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource Id"
                },
                "name": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource name"
                },
                "type": {
                  "readOnly": true,
                  "type": "string",
                  "description": "Resource type"
                },
                "properties": {
                  "type": "object",
                  "properties": {
                    "isEnabled": {
                      "type": "boolean",
                      "description": "Indicates whether Defender for Storage is enabled on this storage account."
                    },
                    "malwareScanning": {
                      "type": "object",
                      "properties": {
                        "onUpload": {
                          "type": "object",
                          "properties": {
                            "isEnabled": {
                              "type": "boolean",
                              "description": "Indicates whether On Upload malware scanning should be enabled."
                            },
                            "capGBPerMonth": {
                              "type": "integer",
                              "format": "int32",
                              "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
                            },
                            "filters": {
                              "x-nullable": true,
                              "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
                              "type": "object",
                              "properties": {
                                "excludeBlobsWithPrefix": {
                                  "type": "array",
                                  "x-nullable": true,
                                  "items": {
                                    "type": "string"
                                  },
                                  "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
                                },
                                "excludeBlobsWithSuffix": {
                                  "type": "array",
                                  "x-nullable": true,
                                  "items": {
                                    "type": "string"
                                  },
                                  "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
                                },
                                "excludeBlobsLargerThan": {
                                  "format": "int64",
                                  "x-nullable": true,
                                  "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
                                }
                              }
                            }
                          },
                          "description": "Properties of On Upload malware scanning."
                        },
                        "scanResultsEventGridTopicResourceId": {
                          "type": "string",
                          "description": "Optional. Resource id of an Event Grid Topic to send scan results to."
                        },
                        "blobScanResultsOptions": {
                          "type": "string",
                          "description": "Optional. Write scan result on blobIndexTags by default.",
                          "enum": [
                            "blobIndexTags",
                            "None"
                          ],
                          "x-ms-enum": {
                            "name": "blobScanResultsOptions",
                            "modelAsString": true,
                            "values": [
                              {
                                "value": "blobIndexTags",
                                "description": "Write scan results on the blobs index tags."
                              },
                              {
                                "value": "None",
                                "description": "Do not write scan results on the blobs index tags."
                              }
                            ]
                          }
                        },
                        "operationStatus": {
                          "type": "object",
                          "readOnly": true,
                          "description": "Upon failure or partial success. Additional data describing Malware Scanning enable/disable operation.",
                          "properties": {
                            "code": {
                              "type": "string",
                              "description": "The operation status code."
                            },
                            "message": {
                              "type": "string",
                              "description": "Additional information regarding the success/failure of the operation."
                            }
                          }
                        }
                      },
                      "description": "Properties of Malware Scanning."
                    },
                    "sensitiveDataDiscovery": {
                      "type": "object",
                      "properties": {
                        "isEnabled": {
                          "type": "boolean",
                          "description": "Indicates whether Sensitive Data Discovery should be enabled."
                        },
                        "operationStatus": {
                          "type": "object",
                          "readOnly": true,
                          "description": "Upon failure or partial success. Additional data describing Sensitive Data Discovery enable/disable operation.",
                          "properties": {
                            "code": {
                              "type": "string",
                              "description": "The operation status code."
                            },
                            "message": {
                              "type": "string",
                              "description": "Additional information regarding the success/failure of the operation."
                            }
                          }
                        }
                      },
                      "description": "Properties of Sensitive Data Discovery."
                    },
                    "overrideSubscriptionLevelSettings": {
                      "type": "boolean",
                      "description": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."
                    }
                  },
                  "description": "Defender for Storage resource properties."
                }
              },
              "description": "The Defender for Storage resource."
            }
          }
        }
      }
    },
    "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{settingName}/startMalwareScan": {
      "post": {
        "tags": [
          "DefenderForStorage",
          "Antimalware",
          "Scan"
        ],
        "description": "Initiate a Defender for Storage malware scan for the specified storage account.",
        "operationId": "DefenderForStorage_StartMalwareScan",
        "parameters": [
          {
            "name": "api-version",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "API version for the operation"
          },
          {
            "name": "resourceId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "The identifier of the resource.",
            "x-ms-parameter-location": "method",
            "x-ms-skip-url-encoding": true
          },
          {
            "name": "settingName",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "^[a-z][a-z0-9]*$",
            "enum": [
              "current"
            ],
            "x-ms-enum": {
              "name": "settingName",
              "modelAsString": true,
              "values": [
                {
                  "value": "current",
                  "description": "Name of the Defender for Storage Settings name."
                }
              ]
            },
            "description": "Defender for Storage setting name.",
            "x-ms-parameter-location": "method"
          }
        ],
        "responses": {
          "200": {
            "description": "The status of the malware scan operation.",
            "schema": {
              "type": "object",
              "properties": {
                "properties": {
                  "type": "object",
                  "properties": {
                    "scanId": {
                      "type": "string",
                      "description": "The identifier of the scan."
                    },
                    "scanStatus": {
                      "type": "string",
                      "description": "A status code of the scan operation."
                    },
                    "scanStatusMessage": {
                      "type": "string",
                      "description": "A description of the status of the scan."
                    },
                    "scanStartTime": {
                      "type": "string",
                      "description": "The time at which the scan had been initiated."
                    },
                    "scanEndTime": {
                      "type": "string",
                      "description": "The time at which the scan has ended. Only available for a scan which has terminated."
                    },
                    "scanSummary": {
                      "type": "object",
                      "description": "A summary of the scan results.",
                      "properties": {
                        "blobs": {
                          "type": "object",
                          "description": "A summary of the scan results of the blobs that were scanned.",
                          "properties": {
                            "totalBlobsScanned": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The total number of blobs that were scanned."
                            },
                            "maliciousBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of malicious blobs that were detected during the scan."
                            },
                            "skippedBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of blobs that were skipped."
                            },
                            "failedBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of failed blob scans."
                            },
                            "scannedBlobsInGB": {
                              "type": "number",
                              "format": "double",
                              "description": "The number of gigabytes of data that were scanned."
                            }
                          }
                        },
                        "estimatedScanCostUSD": {
                          "type": "number",
                          "format": "double",
                          "description": "The estimated cost of the scan. Only available for a scan which has terminated."
                        }
                      }
                    }
                  }
                }
              },
              "description": "Describes the state of a malware scan operation."
            }
          }
        }
      }
    },
    "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{settingName}/malwareScans/{scanId}/cancelMalwareScan": {
      "post": {
        "tags": [
          "DefenderForStorage",
          "Antimalware",
          "Scan"
        ],
        "description": "Cancels a Defender for Storage malware scan for the specified storage account.",
        "operationId": "DefenderForStorage_CancelMalwareScan",
        "parameters": [
          {
            "name": "api-version",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "API version for the operation"
          },
          {
            "name": "resourceId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "The identifier of the resource.",
            "x-ms-parameter-location": "method",
            "x-ms-skip-url-encoding": true
          },
          {
            "name": "settingName",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "^[a-z][a-z0-9]*$",
            "enum": [
              "current"
            ],
            "x-ms-enum": {
              "name": "settingName",
              "modelAsString": true,
              "values": [
                {
                  "value": "current",
                  "description": "Name of the Defender for Storage Settings name."
                }
              ]
            },
            "description": "Defender for Storage setting name.",
            "x-ms-parameter-location": "method"
          },
          {
            "name": "scanId",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "^(latest|[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})$",
            "description": "The identifier of the scan. Can be either 'latest' or a GUID.",
            "x-ms-parameter-location": "method"
          }
        ],
        "responses": {
          "200": {
            "description": "The status of the malware scan operation.",
            "schema": {
              "type": "object",
              "properties": {
                "properties": {
                  "type": "object",
                  "properties": {
                    "scanId": {
                      "type": "string",
                      "description": "The identifier of the scan."
                    },
                    "scanStatus": {
                      "type": "string",
                      "description": "A status code of the scan operation."
                    },
                    "scanStatusMessage": {
                      "type": "string",
                      "description": "A description of the status of the scan."
                    },
                    "scanStartTime": {
                      "type": "string",
                      "description": "The time at which the scan had been initiated."
                    },
                    "scanEndTime": {
                      "type": "string",
                      "description": "The time at which the scan has ended. Only available for a scan which has terminated."
                    },
                    "scanSummary": {
                      "type": "object",
                      "description": "A summary of the scan results.",
                      "properties": {
                        "blobs": {
                          "type": "object",
                          "description": "A summary of the scan results of the blobs that were scanned.",
                          "properties": {
                            "totalBlobsScanned": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The total number of blobs that were scanned."
                            },
                            "maliciousBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of malicious blobs that were detected during the scan."
                            },
                            "skippedBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of blobs that were skipped."
                            },
                            "failedBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of failed blob scans."
                            },
                            "scannedBlobsInGB": {
                              "type": "number",
                              "format": "double",
                              "description": "The number of gigabytes of data that were scanned."
                            }
                          }
                        },
                        "estimatedScanCostUSD": {
                          "type": "number",
                          "format": "double",
                          "description": "The estimated cost of the scan. Only available for a scan which has terminated."
                        }
                      }
                    }
                  }
                }
              },
              "description": "Describes the state of a malware scan operation."
            }
          }
        }
      }
    },
    "/{resourceId}/providers/Microsoft.Security/defenderForStorageSettings/{settingName}/malwareScans/{scanId}": {
      "get": {
        "tags": [
          "DefenderForStorage",
          "Antimalware",
          "Scan"
        ],
        "description": "Gets the Defender for Storage malware scan for the specified storage resource.",
        "operationId": "DefenderForStorage_GetMalwareScan",
        "parameters": [
          {
            "name": "api-version",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "API version for the operation"
          },
          {
            "name": "resourceId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "The identifier of the resource.",
            "x-ms-parameter-location": "method",
            "x-ms-skip-url-encoding": true
          },
          {
            "name": "settingName",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "^[a-z][a-z0-9]*$",
            "enum": [
              "current"
            ],
            "x-ms-enum": {
              "name": "settingName",
              "modelAsString": true,
              "values": [
                {
                  "value": "current",
                  "description": "Name of the Defender for Storage Settings name."
                }
              ]
            },
            "description": "Defender for Storage setting name.",
            "x-ms-parameter-location": "method"
          },
          {
            "name": "scanId",
            "in": "path",
            "required": true,
            "type": "string",
            "pattern": "^(latest|[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})$",
            "description": "The identifier of the scan. Can be either 'latest' or a GUID.",
            "x-ms-parameter-location": "method"
          }
        ],
        "responses": {
          "200": {
            "description": "The state of the malware scan operation.",
            "schema": {
              "type": "object",
              "properties": {
                "properties": {
                  "type": "object",
                  "properties": {
                    "scanId": {
                      "type": "string",
                      "description": "The identifier of the scan."
                    },
                    "scanStatus": {
                      "type": "string",
                      "description": "A status code of the scan operation."
                    },
                    "scanStatusMessage": {
                      "type": "string",
                      "description": "A description of the status of the scan."
                    },
                    "scanStartTime": {
                      "type": "string",
                      "description": "The time at which the scan had been initiated."
                    },
                    "scanEndTime": {
                      "type": "string",
                      "description": "The time at which the scan has ended. Only available for a scan which has terminated."
                    },
                    "scanSummary": {
                      "type": "object",
                      "description": "A summary of the scan results.",
                      "properties": {
                        "blobs": {
                          "type": "object",
                          "description": "A summary of the scan results of the blobs that were scanned.",
                          "properties": {
                            "totalBlobsScanned": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The total number of blobs that were scanned."
                            },
                            "maliciousBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of malicious blobs that were detected during the scan."
                            },
                            "skippedBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of blobs that were skipped."
                            },
                            "failedBlobsCount": {
                              "type": "integer",
                              "format": "int64",
                              "description": "The number of failed blob scans."
                            },
                            "scannedBlobsInGB": {
                              "type": "number",
                              "format": "double",
                              "description": "The number of gigabytes of data that were scanned."
                            }
                          }
                        },
                        "estimatedScanCostUSD": {
                          "type": "number",
                          "format": "double",
                          "description": "The estimated cost of the scan. Only available for a scan which has terminated."
                        }
                      }
                    }
                  }
                }
              },
              "description": "Describes the state of a malware scan operation."
            }
          }
        }
      }
    },
    "/providers/Microsoft.Security/operations": {
      "get": {
        "tags": [
          "Operations"
        ],
        "description": "Exposes all available operations for discovery purposes.",
        "operationId": "Operations_List",
        "parameters": [
          {
            "name": "api-version",
            "in": "query",
            "description": "The API version to use for this operation.",
            "required": true,
            "type": "string",
            "minLength": 1
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "type": "object",
              "description": "A list of REST API operations supported by an Azure Resource Provider. It contains an URL link to get the next set of results.",
              "properties": {
                "value": {
                  "type": "array",
                  "description": "List of operations supported by the resource provider",
                  "items": {
                    "type": "object",
                    "title": "REST API Operation",
                    "description": "Details of a REST API operation, returned from the Resource Provider Operations API",
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "The name of the operation, as per Resource-Based Access Control (RBAC). Examples: \"Microsoft.Compute/virtualMachines/write\", \"Microsoft.Compute/virtualMachines/capture/action\"",
                        "readOnly": true
                      },
                      "isDataAction": {
                        "type": "boolean",
                        "description": "Whether the operation applies to data-plane. This is \"true\" for data-plane operations and \"false\" for ARM/control-plane operations.",
                        "readOnly": true
                      },
                      "display": {
                        "type": "object",
                        "description": "Localized display information for this particular operation.",
                        "properties": {
                          "provider": {
                            "type": "string",
                            "description": "The localized friendly form of the resource provider name, e.g. \"Microsoft Monitoring Insights\" or \"Microsoft Compute\".",
                            "readOnly": true
                          },
                          "resource": {
                            "type": "string",
                            "description": "The localized friendly name of the resource type related to this operation. E.g. \"Virtual Machines\" or \"Job Schedule Collections\".",
                            "readOnly": true
                          },
                          "operation": {
                            "type": "string",
                            "description": "The concise, localized friendly name for the operation; suitable for dropdowns. E.g. \"Create or Update Virtual Machine\", \"Restart Virtual Machine\".",
                            "readOnly": true
                          },
                          "description": {
                            "type": "string",
                            "description": "The short, localized friendly description of the operation; suitable for tool tips and detailed views.",
                            "readOnly": true
                          }
                        }
                      },
                      "origin": {
                        "type": "string",
                        "description": "The intended executor of the operation; as in Resource Based Access Control (RBAC) and audit logs UX. Default value is \"user,system\"",
                        "enum": [
                          "user",
                          "system",
                          "user,system"
                        ],
                        "x-ms-enum": {
                          "name": "Origin",
                          "modelAsString": true
                        },
                        "readOnly": true
                      },
                      "actionType": {
                        "type": "string",
                        "description": "Enum. Indicates the action type. \"Internal\" refers to actions that are for internal only APIs.",
                        "enum": [
                          "Internal"
                        ],
                        "x-ms-enum": {
                          "name": "ActionType",
                          "modelAsString": true
                        },
                        "readOnly": true
                      }
                    }
                  },
                  "readOnly": true,
                  "x-ms-identifiers": [
                    "name"
                  ]
                },
                "nextLink": {
                  "type": "string",
                  "format": "uri",
                  "description": "URL to get the next set of operation list results (if there are any).",
                  "readOnly": true
                }
              }
            }
          }
        }
      }
    }
  },
  "definitions": {
    "DefenderForStorageSetting": {
      "type": "object",
      "properties": {
        "id": {
          "readOnly": true,
          "type": "string",
          "description": "Resource Id"
        },
        "name": {
          "readOnly": true,
          "type": "string",
          "description": "Resource name"
        },
        "type": {
          "readOnly": true,
          "type": "string",
          "description": "Resource type"
        },
        "properties": {
          "type": "object",
          "properties": {
            "isEnabled": {
              "type": "boolean",
              "description": "Indicates whether Defender for Storage is enabled on this storage account."
            },
            "malwareScanning": {
              "type": "object",
              "properties": {
                "onUpload": {
                  "type": "object",
                  "properties": {
                    "isEnabled": {
                      "type": "boolean",
                      "description": "Indicates whether On Upload malware scanning should be enabled."
                    },
                    "capGBPerMonth": {
                      "type": "integer",
                      "format": "int32",
                      "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
                    },
                    "filters": {
                      "x-nullable": true,
                      "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
                      "type": "object",
                      "properties": {
                        "excludeBlobsWithPrefix": {
                          "type": "array",
                          "x-nullable": true,
                          "items": {
                            "type": "string"
                          },
                          "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
                        },
                        "excludeBlobsWithSuffix": {
                          "type": "array",
                          "x-nullable": true,
                          "items": {
                            "type": "string"
                          },
                          "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
                        },
                        "excludeBlobsLargerThan": {
                          "format": "int64",
                          "x-nullable": true,
                          "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
                        }
                      }
                    }
                  },
                  "description": "Properties of On Upload malware scanning."
                },
                "scanResultsEventGridTopicResourceId": {
                  "type": "string",
                  "description": "Optional. Resource id of an Event Grid Topic to send scan results to."
                },
                "blobScanResultsOptions": {
                  "type": "string",
                  "description": "Optional. Write scan result on blobIndexTags by default.",
                  "enum": [
                    "blobIndexTags",
                    "None"
                  ],
                  "x-ms-enum": {
                    "name": "blobScanResultsOptions",
                    "modelAsString": true,
                    "values": [
                      {
                        "value": "blobIndexTags",
                        "description": "Write scan results on the blobs index tags."
                      },
                      {
                        "value": "None",
                        "description": "Do not write scan results on the blobs index tags."
                      }
                    ]
                  }
                },
                "operationStatus": {
                  "type": "object",
                  "readOnly": true,
                  "description": "Upon failure or partial success. Additional data describing Malware Scanning enable/disable operation.",
                  "properties": {
                    "code": {
                      "type": "string",
                      "description": "The operation status code."
                    },
                    "message": {
                      "type": "string",
                      "description": "Additional information regarding the success/failure of the operation."
                    }
                  }
                }
              },
              "description": "Properties of Malware Scanning."
            },
            "sensitiveDataDiscovery": {
              "type": "object",
              "properties": {
                "isEnabled": {
                  "type": "boolean",
                  "description": "Indicates whether Sensitive Data Discovery should be enabled."
                },
                "operationStatus": {
                  "type": "object",
                  "readOnly": true,
                  "description": "Upon failure or partial success. Additional data describing Sensitive Data Discovery enable/disable operation.",
                  "properties": {
                    "code": {
                      "type": "string",
                      "description": "The operation status code."
                    },
                    "message": {
                      "type": "string",
                      "description": "Additional information regarding the success/failure of the operation."
                    }
                  }
                }
              },
              "description": "Properties of Sensitive Data Discovery."
            },
            "overrideSubscriptionLevelSettings": {
              "type": "boolean",
              "description": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."
            }
          },
          "description": "Defender for Storage resource properties."
        }
      },
      "description": "The Defender for Storage resource."
    },
    "DefenderForStorageSettingProperties": {
      "type": "object",
      "properties": {
        "isEnabled": {
          "type": "boolean",
          "description": "Indicates whether Defender for Storage is enabled on this storage account."
        },
        "malwareScanning": {
          "type": "object",
          "properties": {
            "onUpload": {
              "type": "object",
              "properties": {
                "isEnabled": {
                  "type": "boolean",
                  "description": "Indicates whether On Upload malware scanning should be enabled."
                },
                "capGBPerMonth": {
                  "type": "integer",
                  "format": "int32",
                  "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
                },
                "filters": {
                  "x-nullable": true,
                  "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
                  "type": "object",
                  "properties": {
                    "excludeBlobsWithPrefix": {
                      "type": "array",
                      "x-nullable": true,
                      "items": {
                        "type": "string"
                      },
                      "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
                    },
                    "excludeBlobsWithSuffix": {
                      "type": "array",
                      "x-nullable": true,
                      "items": {
                        "type": "string"
                      },
                      "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
                    },
                    "excludeBlobsLargerThan": {
                      "format": "int64",
                      "x-nullable": true,
                      "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
                    }
                  }
                }
              },
              "description": "Properties of On Upload malware scanning."
            },
            "scanResultsEventGridTopicResourceId": {
              "type": "string",
              "description": "Optional. Resource id of an Event Grid Topic to send scan results to."
            },
            "blobScanResultsOptions": {
              "type": "string",
              "description": "Optional. Write scan result on blobIndexTags by default.",
              "enum": [
                "blobIndexTags",
                "None"
              ],
              "x-ms-enum": {
                "name": "blobScanResultsOptions",
                "modelAsString": true,
                "values": [
                  {
                    "value": "blobIndexTags",
                    "description": "Write scan results on the blobs index tags."
                  },
                  {
                    "value": "None",
                    "description": "Do not write scan results on the blobs index tags."
                  }
                ]
              }
            },
            "operationStatus": {
              "type": "object",
              "readOnly": true,
              "description": "Upon failure or partial success. Additional data describing Malware Scanning enable/disable operation.",
              "properties": {
                "code": {
                  "type": "string",
                  "description": "The operation status code."
                },
                "message": {
                  "type": "string",
                  "description": "Additional information regarding the success/failure of the operation."
                }
              }
            }
          },
          "description": "Properties of Malware Scanning."
        },
        "sensitiveDataDiscovery": {
          "type": "object",
          "properties": {
            "isEnabled": {
              "type": "boolean",
              "description": "Indicates whether Sensitive Data Discovery should be enabled."
            },
            "operationStatus": {
              "type": "object",
              "readOnly": true,
              "description": "Upon failure or partial success. Additional data describing Sensitive Data Discovery enable/disable operation.",
              "properties": {
                "code": {
                  "type": "string",
                  "description": "The operation status code."
                },
                "message": {
                  "type": "string",
                  "description": "Additional information regarding the success/failure of the operation."
                }
              }
            }
          },
          "description": "Properties of Sensitive Data Discovery."
        },
        "overrideSubscriptionLevelSettings": {
          "type": "boolean",
          "description": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."
        }
      },
      "description": "Defender for Storage resource properties."
    },
    "MalwareScanningProperties": {
      "type": "object",
      "properties": {
        "onUpload": {
          "type": "object",
          "properties": {
            "isEnabled": {
              "type": "boolean",
              "description": "Indicates whether On Upload malware scanning should be enabled."
            },
            "capGBPerMonth": {
              "type": "integer",
              "format": "int32",
              "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
            },
            "filters": {
              "x-nullable": true,
              "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
              "type": "object",
              "properties": {
                "excludeBlobsWithPrefix": {
                  "type": "array",
                  "x-nullable": true,
                  "items": {
                    "type": "string"
                  },
                  "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
                },
                "excludeBlobsWithSuffix": {
                  "type": "array",
                  "x-nullable": true,
                  "items": {
                    "type": "string"
                  },
                  "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
                },
                "excludeBlobsLargerThan": {
                  "format": "int64",
                  "x-nullable": true,
                  "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
                }
              }
            }
          },
          "description": "Properties of On Upload malware scanning."
        },
        "scanResultsEventGridTopicResourceId": {
          "type": "string",
          "description": "Optional. Resource id of an Event Grid Topic to send scan results to."
        },
        "blobScanResultsOptions": {
          "type": "string",
          "description": "Optional. Write scan result on blobIndexTags by default.",
          "enum": [
            "blobIndexTags",
            "None"
          ],
          "x-ms-enum": {
            "name": "blobScanResultsOptions",
            "modelAsString": true,
            "values": [
              {
                "value": "blobIndexTags",
                "description": "Write scan results on the blobs index tags."
              },
              {
                "value": "None",
                "description": "Do not write scan results on the blobs index tags."
              }
            ]
          }
        },
        "operationStatus": {
          "type": "object",
          "readOnly": true,
          "description": "Upon failure or partial success. Additional data describing Malware Scanning enable/disable operation.",
          "properties": {
            "code": {
              "type": "string",
              "description": "The operation status code."
            },
            "message": {
              "type": "string",
              "description": "Additional information regarding the success/failure of the operation."
            }
          }
        }
      },
      "description": "Properties of Malware Scanning."
    },
    "OnUploadProperties": {
      "type": "object",
      "properties": {
        "isEnabled": {
          "type": "boolean",
          "description": "Indicates whether On Upload malware scanning should be enabled."
        },
        "capGBPerMonth": {
          "type": "integer",
          "format": "int32",
          "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
        },
        "filters": {
          "x-nullable": true,
          "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
          "type": "object",
          "properties": {
            "excludeBlobsWithPrefix": {
              "type": "array",
              "x-nullable": true,
              "items": {
                "type": "string"
              },
              "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
            },
            "excludeBlobsWithSuffix": {
              "type": "array",
              "x-nullable": true,
              "items": {
                "type": "string"
              },
              "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
            },
            "excludeBlobsLargerThan": {
              "format": "int64",
              "x-nullable": true,
              "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
            }
          }
        }
      },
      "description": "Properties of On Upload malware scanning."
    },
    "OnUploadFilters": {
      "type": "object",
      "properties": {
        "excludeBlobsWithPrefix": {
          "type": "array",
          "x-nullable": true,
          "items": {
            "type": "string"
          },
          "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
        },
        "excludeBlobsWithSuffix": {
          "type": "array",
          "x-nullable": true,
          "items": {
            "type": "string"
          },
          "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
        },
        "excludeBlobsLargerThan": {
          "format": "int64",
          "x-nullable": true,
          "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
        }
      },
      "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type."
    },
    "SensitiveDataDiscoveryProperties": {
      "type": "object",
      "properties": {
        "isEnabled": {
          "type": "boolean",
          "description": "Indicates whether Sensitive Data Discovery should be enabled."
        },
        "operationStatus": {
          "type": "object",
          "readOnly": true,
          "description": "Upon failure or partial success. Additional data describing Sensitive Data Discovery enable/disable operation.",
          "properties": {
            "code": {
              "type": "string",
              "description": "The operation status code."
            },
            "message": {
              "type": "string",
              "description": "Additional information regarding the success/failure of the operation."
            }
          }
        }
      },
      "description": "Properties of Sensitive Data Discovery."
    },
    "OperationStatus": {
      "type": "object",
      "description": "A status describing the success/failure of the enablement/disablement operation.",
      "properties": {
        "code": {
          "type": "string",
          "description": "The operation status code."
        },
        "message": {
          "type": "string",
          "description": "Additional information regarding the success/failure of the operation."
        }
      }
    },
    "MalwareScan": {
      "type": "object",
      "properties": {
        "properties": {
          "type": "object",
          "properties": {
            "scanId": {
              "type": "string",
              "description": "The identifier of the scan."
            },
            "scanStatus": {
              "type": "string",
              "description": "A status code of the scan operation."
            },
            "scanStatusMessage": {
              "type": "string",
              "description": "A description of the status of the scan."
            },
            "scanStartTime": {
              "type": "string",
              "description": "The time at which the scan had been initiated."
            },
            "scanEndTime": {
              "type": "string",
              "description": "The time at which the scan has ended. Only available for a scan which has terminated."
            },
            "scanSummary": {
              "type": "object",
              "description": "A summary of the scan results.",
              "properties": {
                "blobs": {
                  "type": "object",
                  "description": "A summary of the scan results of the blobs that were scanned.",
                  "properties": {
                    "totalBlobsScanned": {
                      "type": "integer",
                      "format": "int64",
                      "description": "The total number of blobs that were scanned."
                    },
                    "maliciousBlobsCount": {
                      "type": "integer",
                      "format": "int64",
                      "description": "The number of malicious blobs that were detected during the scan."
                    },
                    "skippedBlobsCount": {
                      "type": "integer",
                      "format": "int64",
                      "description": "The number of blobs that were skipped."
                    },
                    "failedBlobsCount": {
                      "type": "integer",
                      "format": "int64",
                      "description": "The number of failed blob scans."
                    },
                    "scannedBlobsInGB": {
                      "type": "number",
                      "format": "double",
                      "description": "The number of gigabytes of data that were scanned."
                    }
                  }
                },
                "estimatedScanCostUSD": {
                  "type": "number",
                  "format": "double",
                  "description": "The estimated cost of the scan. Only available for a scan which has terminated."
                }
              }
            }
          }
        }
      },
      "description": "Describes the state of a malware scan operation."
    },
    "MalwareScanProperties": {
      "type": "object",
      "properties": {
        "scanId": {
          "type": "string",
          "description": "The identifier of the scan."
        },
        "scanStatus": {
          "type": "string",
          "description": "A status code of the scan operation."
        },
        "scanStatusMessage": {
          "type": "string",
          "description": "A description of the status of the scan."
        },
        "scanStartTime": {
          "type": "string",
          "description": "The time at which the scan had been initiated."
        },
        "scanEndTime": {
          "type": "string",
          "description": "The time at which the scan has ended. Only available for a scan which has terminated."
        },
        "scanSummary": {
          "type": "object",
          "description": "A summary of the scan results.",
          "properties": {
            "blobs": {
              "type": "object",
              "description": "A summary of the scan results of the blobs that were scanned.",
              "properties": {
                "totalBlobsScanned": {
                  "type": "integer",
                  "format": "int64",
                  "description": "The total number of blobs that were scanned."
                },
                "maliciousBlobsCount": {
                  "type": "integer",
                  "format": "int64",
                  "description": "The number of malicious blobs that were detected during the scan."
                },
                "skippedBlobsCount": {
                  "type": "integer",
                  "format": "int64",
                  "description": "The number of blobs that were skipped."
                },
                "failedBlobsCount": {
                  "type": "integer",
                  "format": "int64",
                  "description": "The number of failed blob scans."
                },
                "scannedBlobsInGB": {
                  "type": "number",
                  "format": "double",
                  "description": "The number of gigabytes of data that were scanned."
                }
              }
            },
            "estimatedScanCostUSD": {
              "type": "number",
              "format": "double",
              "description": "The estimated cost of the scan. Only available for a scan which has terminated."
            }
          }
        }
      }
    },
    "ScanSummary": {
      "type": "object",
      "description": "A summary of the scan results.",
      "properties": {
        "blobs": {
          "type": "object",
          "description": "A summary of the scan results of the blobs that were scanned.",
          "properties": {
            "totalBlobsScanned": {
              "type": "integer",
              "format": "int64",
              "description": "The total number of blobs that were scanned."
            },
            "maliciousBlobsCount": {
              "type": "integer",
              "format": "int64",
              "description": "The number of malicious blobs that were detected during the scan."
            },
            "skippedBlobsCount": {
              "type": "integer",
              "format": "int64",
              "description": "The number of blobs that were skipped."
            },
            "failedBlobsCount": {
              "type": "integer",
              "format": "int64",
              "description": "The number of failed blob scans."
            },
            "scannedBlobsInGB": {
              "type": "number",
              "format": "double",
              "description": "The number of gigabytes of data that were scanned."
            }
          }
        },
        "estimatedScanCostUSD": {
          "type": "number",
          "format": "double",
          "description": "The estimated cost of the scan. Only available for a scan which has terminated."
        }
      }
    },
    "BlobsScanSummary": {
      "type": "object",
      "description": "A summary of the scan results of the blobs that were scanned.",
      "properties": {
        "totalBlobsScanned": {
          "type": "integer",
          "format": "int64",
          "description": "The total number of blobs that were scanned."
        },
        "maliciousBlobsCount": {
          "type": "integer",
          "format": "int64",
          "description": "The number of malicious blobs that were detected during the scan."
        },
        "skippedBlobsCount": {
          "type": "integer",
          "format": "int64",
          "description": "The number of blobs that were skipped."
        },
        "failedBlobsCount": {
          "type": "integer",
          "format": "int64",
          "description": "The number of failed blob scans."
        },
        "scannedBlobsInGB": {
          "type": "number",
          "format": "double",
          "description": "The number of gigabytes of data that were scanned."
        }
      }
    }
  },
  "parameters": {
    "DefenderForStorageSettingName": {
      "name": "settingName",
      "in": "path",
      "required": true,
      "type": "string",
      "pattern": "^[a-z][a-z0-9]*$",
      "enum": [
        "current"
      ],
      "x-ms-enum": {
        "name": "settingName",
        "modelAsString": true,
        "values": [
          {
            "value": "current",
            "description": "Name of the Defender for Storage Settings name."
          }
        ]
      },
      "description": "Defender for Storage setting name.",
      "x-ms-parameter-location": "method"
    },
    "DefenderForStorageSetting": {
      "name": "defenderForStorageSetting",
      "in": "body",
      "required": true,
      "description": "Defender for Storage Settings",
      "schema": {
        "type": "object",
        "properties": {
          "id": {
            "readOnly": true,
            "type": "string",
            "description": "Resource Id"
          },
          "name": {
            "readOnly": true,
            "type": "string",
            "description": "Resource name"
          },
          "type": {
            "readOnly": true,
            "type": "string",
            "description": "Resource type"
          },
          "properties": {
            "type": "object",
            "properties": {
              "isEnabled": {
                "type": "boolean",
                "description": "Indicates whether Defender for Storage is enabled on this storage account."
              },
              "malwareScanning": {
                "type": "object",
                "properties": {
                  "onUpload": {
                    "type": "object",
                    "properties": {
                      "isEnabled": {
                        "type": "boolean",
                        "description": "Indicates whether On Upload malware scanning should be enabled."
                      },
                      "capGBPerMonth": {
                        "type": "integer",
                        "format": "int32",
                        "description": "Defines the max GB to be scanned per Month. Set to -1 if no capping is needed. If not specified, the default value is -1."
                      },
                      "filters": {
                        "x-nullable": true,
                        "description": "Optional. Determine which blobs get scanned by On Upload malware scanning. An Or operation is performed between each filter type.",
                        "type": "object",
                        "properties": {
                          "excludeBlobsWithPrefix": {
                            "type": "array",
                            "x-nullable": true,
                            "items": {
                              "type": "string"
                            },
                            "description": "Optional. A list of prefixes to exclude from on-upload malware scanning.\nFormat: `container-name/blob-name` (start with the container name; do not include the storage account name).\nExclude entire containers: Use prefix of container names you want to exclude without a trailing `/`.\nExclude a single container: Add a trailing slash `/` after the container name to avoid excluding other containers with similar prefixes."
                          },
                          "excludeBlobsWithSuffix": {
                            "type": "array",
                            "x-nullable": true,
                            "items": {
                              "type": "string"
                            },
                            "description": "Optional. A list of suffixes to exclude from on-upload malware scanning. Suffixes match only the end of blob names, and should be used for file extensions or blob name endings only."
                          },
                          "excludeBlobsLargerThan": {
                            "format": "int64",
                            "x-nullable": true,
                            "description": "Optional. Specifies the maximum size in bytes for blobs to be scanned. This parameter accepts a single positive integer value. Blobs larger than this value will be excluded from scanning."
                          }
                        }
                      }
                    },
                    "description": "Properties of On Upload malware scanning."
                  },
                  "scanResultsEventGridTopicResourceId": {
                    "type": "string",
                    "description": "Optional. Resource id of an Event Grid Topic to send scan results to."
                  },
                  "blobScanResultsOptions": {
                    "type": "string",
                    "description": "Optional. Write scan result on blobIndexTags by default.",
                    "enum": [
                      "blobIndexTags",
                      "None"
                    ],
                    "x-ms-enum": {
                      "name": "blobScanResultsOptions",
                      "modelAsString": true,
                      "values": [
                        {
                          "value": "blobIndexTags",
                          "description": "Write scan results on the blobs index tags."
                        },
                        {
                          "value": "None",
                          "description": "Do not write scan results on the blobs index tags."
                        }
                      ]
                    }
                  },
                  "operationStatus": {
                    "type": "object",
                    "readOnly": true,
                    "description": "Upon failure or partial success. Additional data describing Malware Scanning enable/disable operation.",
                    "properties": {
                      "code": {
                        "type": "string",
                        "description": "The operation status code."
                      },
                      "message": {
                        "type": "string",
                        "description": "Additional information regarding the success/failure of the operation."
                      }
                    }
                  }
                },
                "description": "Properties of Malware Scanning."
              },
              "sensitiveDataDiscovery": {
                "type": "object",
                "properties": {
                  "isEnabled": {
                    "type": "boolean",
                    "description": "Indicates whether Sensitive Data Discovery should be enabled."
                  },
                  "operationStatus": {
                    "type": "object",
                    "readOnly": true,
                    "description": "Upon failure or partial success. Additional data describing Sensitive Data Discovery enable/disable operation.",
                    "properties": {
                      "code": {
                        "type": "string",
                        "description": "The operation status code."
                      },
                      "message": {
                        "type": "string",
                        "description": "Additional information regarding the success/failure of the operation."
                      }
                    }
                  }
                },
                "description": "Properties of Sensitive Data Discovery."
              },
              "overrideSubscriptionLevelSettings": {
                "type": "boolean",
                "description": "Indicates whether the settings defined for this storage account should override the settings defined for the subscription."
              }
            },
            "description": "Defender for Storage resource properties."
          }
        },
        "description": "The Defender for Storage resource."
      },
      "x-ms-parameter-location": "method"
    },
    "ScanId": {
      "name": "scanId",
      "in": "path",
      "required": true,
      "type": "string",
      "pattern": "^(latest|[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})$",
      "description": "The identifier of the scan. Can be either 'latest' or a GUID.",
      "x-ms-parameter-location": "method"
    }
  }
}